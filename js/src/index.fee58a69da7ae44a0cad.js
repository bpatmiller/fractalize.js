/*! For license information please see index.fee58a69da7ae44a0cad.js.LICENSE.txt */
(self.webpackChunkfractalize=self.webpackChunkfractalize||[]).push([[927],{938:(t,e,i)=>{"use strict";i.d(e,{a:()=>n,c:()=>r,g:()=>s});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function s(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e,i){return t(i={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&i.path)}},i.exports),i.exports}},6887:(t,e,i)=>{"use strict";var n={};i.r(n),i.d(n,{__moduleExports:()=>y,default:()=>E,plugins:()=>C});var s=i(6379),r=i(938),o=(0,r.c)((function(t,e){!function(e){var i=function(t){return.5*(Math.exp(t)+Math.exp(-t))},n=function(t){return.5*(Math.exp(t)-Math.exp(-t))},s=function(){throw SyntaxError("Invalid Param")};function r(t,e){var i=Math.abs(t),n=Math.abs(e);return 0===t?Math.log(n):0===e?Math.log(i):i<3e3&&n<3e3?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}function o(t,e){if(!(this instanceof o))return new o(t,e);var i=function(t,e){var i={re:0,im:0};if(null==t)i.re=i.im=0;else if(void 0!==e)i.re=t,i.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)i.re=t.re,i.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return o.INFINITY;i.re=t.abs*Math.cos(t.arg),i.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return o.INFINITY;i.re=t.r*Math.cos(t.phi),i.im=t.r*Math.sin(t.phi)}else 2===t.length?(i.re=t[0],i.im=t[1]):s();break;case"string":i.im=i.re=0;var n=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),r=1,a=0;null===n&&s();for(var l=0;l<n.length;l++){var c=n[l];" "===c||"\t"===c||"\n"===c||("+"===c?r++:"-"===c?a++:"i"===c||"I"===c?(r+a===0&&s()," "===n[l+1]||isNaN(n[l+1])?i.im+=parseFloat((a%2?"-":"")+"1"):(i.im+=parseFloat((a%2?"-":"")+n[l+1]),l++),r=a=0):((r+a===0||isNaN(c))&&s(),"i"===n[l+1]||"I"===n[l+1]?(i.im+=parseFloat((a%2?"-":"")+c),l++):i.re+=parseFloat((a%2?"-":"")+c),r=a=0))}r+a>0&&s();break;case"number":i.im=0,i.re=t;break;default:s()}return i}(t,e);this.re=i.re,this.im=i.im}o.prototype={re:0,im:0,sign:function(){var t=this.abs();return new o(this.re/t,this.im/t)},add:function(t,e){var i=new o(t,e);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re+i.re,this.im+i.im)},sub:function(t,e){var i=new o(t,e);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re-i.re,this.im-i.im)},mul:function(t,e){var i=new o(t,e);return this.isInfinite()&&i.isZero()||this.isZero()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:0===i.im&&0===this.im?new o(this.re*i.re,0):new o(this.re*i.re-this.im*i.im,this.re*i.im+this.im*i.re)},div:function(t,e){var i=new o(t,e);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return o.NAN;if(this.isInfinite()||i.isZero())return o.INFINITY;if(this.isZero()||i.isInfinite())return o.ZERO;t=this.re,e=this.im;var n,s,r=i.re,a=i.im;return 0===a?new o(t/r,e/r):Math.abs(r)<Math.abs(a)?new o((t*(s=r/a)+e)/(n=r*s+a),(e*s-t)/n):new o((t+e*(s=a/r))/(n=a*s+r),(e-t*s)/n)},pow:function(t,e){var i=new o(t,e);if(t=this.re,e=this.im,i.isZero())return o.ONE;if(0===i.im){if(0===e&&t>0)return new o(Math.pow(t,i.re),0);if(0===t)switch((i.re%4+4)%4){case 0:return new o(Math.pow(e,i.re),0);case 1:return new o(0,Math.pow(e,i.re));case 2:return new o(-Math.pow(e,i.re),0);case 3:return new o(0,-Math.pow(e,i.re))}}if(0===t&&0===e&&i.re>0&&i.im>=0)return o.ZERO;var n=Math.atan2(e,t),s=r(t,e);return t=Math.exp(i.re*s-i.im*n),e=i.im*s+i.re*n,new o(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,i=this.re,n=this.im,s=this.abs();if(i>=0){if(0===n)return new o(Math.sqrt(i),0);t=.5*Math.sqrt(2*(s+i))}else t=Math.abs(n)/Math.sqrt(2*(s-i));return e=i<=0?.5*Math.sqrt(2*(s-i)):Math.abs(n)/Math.sqrt(2*(s+i)),new o(t,n<0?-e:e)},exp:function(){var t=Math.exp(this.re);return this.im,new o(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){var t=this.re,e=this.im;return new o(Math.expm1(t)*Math.cos(e)+function(t){var e=Math.PI/4;if(-e>t||t>e)return Math.cos(t)-1;var i=t*t;return i*(i*(i*(i*(i*(i*(i*(i/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this.re,e=this.im;return new o(r(t,e),Math.atan2(e,t))},abs:function(){return t=this.re,e=this.im,i=Math.abs(t),n=Math.abs(e),i<3e3&&n<3e3?Math.sqrt(i*i+n*n):(i<n?(i=n,n=t/e):n=e/t,i*Math.sqrt(1+n*n));var t,e,i,n},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new o(Math.sin(t)*i(e),Math.cos(t)*n(e))},cos:function(){var t=this.re,e=this.im;return new o(Math.cos(t)*i(e),-Math.sin(t)*n(e))},tan:function(){var t=2*this.re,e=2*this.im,s=Math.cos(t)+i(e);return new o(Math.sin(t)/s,n(e)/s)},cot:function(){var t=2*this.re,e=2*this.im,s=Math.cos(t)-i(e);return new o(-Math.sin(t)/s,n(e)/s)},sec:function(){var t=this.re,e=this.im,s=.5*i(2*e)+.5*Math.cos(2*t);return new o(Math.cos(t)*i(e)/s,Math.sin(t)*n(e)/s)},csc:function(){var t=this.re,e=this.im,s=.5*i(2*e)-.5*Math.cos(2*t);return new o(Math.sin(t)*i(e)/s,-Math.cos(t)*n(e)/s)},asin:function(){var t=this.re,e=this.im,i=new o(e*e-t*t+1,-2*t*e).sqrt(),n=new o(i.re-e,i.im+t).log();return new o(n.im,-n.re)},acos:function(){var t=this.re,e=this.im,i=new o(e*e-t*t+1,-2*t*e).sqrt(),n=new o(i.re-e,i.im+t).log();return new o(Math.PI/2-n.im,n.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new o(0,1/0);if(-1===e)return new o(0,-1/0)}var i=t*t+(1-e)*(1-e),n=new o((1-e*e-t*t)/i,-2*t/i).log();return new o(-.5*n.im,.5*n.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new o(Math.atan2(1,t),0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).atan():new o(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new o(0,1/0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).acos():new o(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new o(Math.PI/2,1/0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).asin():new o(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new o(n(t)*Math.cos(e),i(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new o(i(t)*Math.cos(e),n(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,s=i(t)+Math.cos(e);return new o(n(t)/s,Math.sin(e)/s)},coth:function(){var t=2*this.re,e=2*this.im,s=i(t)-Math.cos(e);return new o(n(t)/s,-Math.sin(e)/s)},csch:function(){var t=this.re,e=this.im,s=Math.cos(2*e)-i(2*t);return new o(-2*n(t)*Math.cos(e)/s,2*i(t)*Math.sin(e)/s)},sech:function(){var t=this.re,e=this.im,s=Math.cos(2*e)+i(2*t);return new o(2*i(t)*Math.cos(e)/s,-2*n(t)*Math.sin(e)/s)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t=this.acos();if(t.im<=0){var e=t.re;t.re=-t.im,t.im=e}else e=t.im,t.im=-t.re,t.re=e;return t},atanh:function(){var t=this.re,e=this.im,i=t>1&&0===e,n=1-t,s=1+t,a=n*n+e*e,l=0!==a?new o((s*n-e*e)/a,(e*n+s*e)/a):new o(-1!==t?t/0:0,0!==e?e/0:0),c=l.re;return l.re=r(l.re,l.im)/2,l.im=Math.atan2(l.im,c)/2,i&&(l.im=-l.im),l},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new o(0,Math.PI/2);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).atanh():new o(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new o(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).asinh():new o(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(this.isZero())return o.INFINITY;var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).acosh():new o(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return o.INFINITY;if(this.isInfinite())return o.ZERO;var t=this.re,e=this.im,i=t*t+e*e;return new o(t/i,-e/i)},conjugate:function(){return new o(this.re,-this.im)},neg:function(){return new o(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new o(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new o(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new o(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){var i=new o(t,e);return Math.abs(i.re-this.re)<=o.EPSILON&&Math.abs(i.im-this.im)<=o.EPSILON},clone:function(){return new o(this.re,this.im)},toString:function(){var t=this.re,e=this.im,i="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<o.EPSILON&&(t=0),Math.abs(e)<o.EPSILON&&(e=0),0===e?i+t:(0!==t?(i+=t,i+=" ",e<0?(e=-e,i+="-"):i+="+",i+=" "):e<0&&(e=-e,i+="-"),1!==e&&(i+=e),i+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},o.ZERO=new o(0,0),o.ONE=new o(1,0),o.I=new o(0,1),o.PI=new o(Math.PI,0),o.E=new o(Math.E,0),o.INFINITY=new o(1/0,1/0),o.NAN=new o(NaN,NaN),o.EPSILON=1e-15,Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Complex=o,t.exports=o}()})).Complex,a=i(7715),l=i(3638);const c={type:"change"},h={type:"start"},p={type:"end"};class u extends l.aQ{constructor(t,e){super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new l.fH,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:l.ck.ROTATE,MIDDLE:l.ck.DOLLY,RIGHT:l.ck.PAN},this.touches={ONE:l.f9.ROTATE,TWO:l.f9.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.listenToKeyEvents=function(t){t.addEventListener("keydown",U),this._domElementKeyEvents=t},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(c),i.update(),s=n.NONE},this.update=function(){const e=new l.fH,h=(new l.dx).setFromUnitVectors(t.up,new l.fH(0,1,0)),p=h.clone().invert(),m=new l.fH,b=new l.dx,g=2*Math.PI;return function(){const t=i.object.position;e.copy(t).sub(i.target),e.applyQuaternion(h),o.setFromVector3(e),i.autoRotate&&s===n.NONE&&k(2*Math.PI/60/60*i.autoRotateSpeed),i.enableDamping?(o.theta+=a.theta*i.dampingFactor,o.phi+=a.phi*i.dampingFactor):(o.theta+=a.theta,o.phi+=a.phi);let l=i.minAzimuthAngle,f=i.maxAzimuthAngle;return isFinite(l)&&isFinite(f)&&(l<-Math.PI?l+=g:l>Math.PI&&(l-=g),f<-Math.PI?f+=g:f>Math.PI&&(f-=g),o.theta=l<=f?Math.max(l,Math.min(f,o.theta)):o.theta>(l+f)/2?Math.max(l,o.theta):Math.min(f,o.theta)),o.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=u,o.radius=Math.max(i.minDistance,Math.min(i.maxDistance,o.radius)),!0===i.enableDamping?i.target.addScaledVector(d,i.dampingFactor):i.target.add(d),e.setFromSpherical(o),e.applyQuaternion(p),t.copy(i.target).add(e),i.object.lookAt(i.target),!0===i.enableDamping?(a.theta*=1-i.dampingFactor,a.phi*=1-i.dampingFactor,d.multiplyScalar(1-i.dampingFactor)):(a.set(0,0,0),d.set(0,0,0)),u=1,!!(v||m.distanceToSquared(i.object.position)>r||8*(1-b.dot(i.object.quaternion))>r)&&(i.dispatchEvent(c),m.copy(i.object.position),b.copy(i.object.quaternion),v=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",$),i.domElement.removeEventListener("pointerdown",R),i.domElement.removeEventListener("pointercancel",B),i.domElement.removeEventListener("wheel",Y),i.domElement.ownerDocument.removeEventListener("pointermove",q),i.domElement.ownerDocument.removeEventListener("pointerup",H),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",U)};const i=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=n.NONE;const r=1e-6,o=new l.eR,a=new l.eR;let u=1;const d=new l.fH;let v=!1;const m=new l.fG,b=new l.fG,g=new l.fG,f=new l.fG,w=new l.fG,_=new l.fG,x=new l.fG,y=new l.fG,E=new l.fG,C=[],P={};function M(){return Math.pow(.95,i.zoomSpeed)}function k(t){a.theta-=t}function z(t){a.phi-=t}const V=function(){const t=new l.fH;return function(e,i){t.setFromMatrixColumn(i,0),t.multiplyScalar(-e),d.add(t)}}(),L=function(){const t=new l.fH;return function(e,n){!0===i.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(i.object.up,t)),t.multiplyScalar(e),d.add(t)}}(),T=function(){const t=new l.fH;return function(e,n){const s=i.domElement;if(i.object.isPerspectiveCamera){const r=i.object.position;t.copy(r).sub(i.target);let o=t.length();o*=Math.tan(i.object.fov/2*Math.PI/180),V(2*e*o/s.clientHeight,i.object.matrix),L(2*n*o/s.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(V(e*(i.object.right-i.object.left)/i.object.zoom/s.clientWidth,i.object.matrix),L(n*(i.object.top-i.object.bottom)/i.object.zoom/s.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function N(t){i.object.isPerspectiveCamera?u/=t:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*t)),i.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function I(t){i.object.isPerspectiveCamera?u*=t:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/t)),i.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function S(t){m.set(t.clientX,t.clientY)}function j(t){f.set(t.clientX,t.clientY)}function O(){if(1===C.length)m.set(C[0].pageX,C[0].pageY);else{const t=.5*(C[0].pageX+C[1].pageX),e=.5*(C[0].pageY+C[1].pageY);m.set(t,e)}}function D(){if(1===C.length)f.set(C[0].pageX,C[0].pageY);else{const t=.5*(C[0].pageX+C[1].pageX),e=.5*(C[0].pageY+C[1].pageY);f.set(t,e)}}function A(){const t=C[0].pageX-C[1].pageX,e=C[0].pageY-C[1].pageY,i=Math.sqrt(t*t+e*e);x.set(0,i)}function K(t){if(1==C.length)b.set(t.pageX,t.pageY);else{const e=W(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);b.set(i,n)}g.subVectors(b,m).multiplyScalar(i.rotateSpeed);const e=i.domElement;k(2*Math.PI*g.x/e.clientHeight),z(2*Math.PI*g.y/e.clientHeight),m.copy(b)}function G(t){if(1===C.length)w.set(t.pageX,t.pageY);else{const e=W(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);w.set(i,n)}_.subVectors(w,f).multiplyScalar(i.panSpeed),T(_.x,_.y),f.copy(w)}function F(t){const e=W(t),n=t.pageX-e.x,s=t.pageY-e.y,r=Math.sqrt(n*n+s*s);y.set(0,r),E.set(0,Math.pow(y.y/x.y,i.zoomSpeed)),N(E.y),x.copy(y)}function R(t){!1!==i.enabled&&(0===C.length&&(i.domElement.ownerDocument.addEventListener("pointermove",q),i.domElement.ownerDocument.addEventListener("pointerup",H)),function(t){C.push(t)}(t),"touch"===t.pointerType?function(t){switch(X(t),C.length){case 1:switch(i.touches.ONE){case l.f9.ROTATE:if(!1===i.enableRotate)return;O(),s=n.TOUCH_ROTATE;break;case l.f9.PAN:if(!1===i.enablePan)return;D(),s=n.TOUCH_PAN;break;default:s=n.NONE}break;case 2:switch(i.touches.TWO){case l.f9.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;i.enableZoom&&A(),i.enablePan&&D(),s=n.TOUCH_DOLLY_PAN;break;case l.f9.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;i.enableZoom&&A(),i.enableRotate&&O(),s=n.TOUCH_DOLLY_ROTATE;break;default:s=n.NONE}break;default:s=n.NONE}s!==n.NONE&&i.dispatchEvent(h)}(t):function(t){let e;switch(t.button){case 0:e=i.mouseButtons.LEFT;break;case 1:e=i.mouseButtons.MIDDLE;break;case 2:e=i.mouseButtons.RIGHT;break;default:e=-1}switch(e){case l.ck.DOLLY:if(!1===i.enableZoom)return;!function(t){x.set(t.clientX,t.clientY)}(t),s=n.DOLLY;break;case l.ck.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===i.enablePan)return;j(t),s=n.PAN}else{if(!1===i.enableRotate)return;S(t),s=n.ROTATE}break;case l.ck.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===i.enableRotate)return;S(t),s=n.ROTATE}else{if(!1===i.enablePan)return;j(t),s=n.PAN}break;default:s=n.NONE}s!==n.NONE&&i.dispatchEvent(h)}(t))}function q(t){!1!==i.enabled&&("touch"===t.pointerType?function(t){switch(X(t),s){case n.TOUCH_ROTATE:if(!1===i.enableRotate)return;K(t),i.update();break;case n.TOUCH_PAN:if(!1===i.enablePan)return;G(t),i.update();break;case n.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;!function(t){i.enableZoom&&F(t),i.enablePan&&G(t)}(t),i.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;!function(t){i.enableZoom&&F(t),i.enableRotate&&K(t)}(t),i.update();break;default:s=n.NONE}}(t):function(t){if(!1!==i.enabled)switch(s){case n.ROTATE:if(!1===i.enableRotate)return;!function(t){b.set(t.clientX,t.clientY),g.subVectors(b,m).multiplyScalar(i.rotateSpeed);const e=i.domElement;k(2*Math.PI*g.x/e.clientHeight),z(2*Math.PI*g.y/e.clientHeight),m.copy(b),i.update()}(t);break;case n.DOLLY:if(!1===i.enableZoom)return;!function(t){y.set(t.clientX,t.clientY),E.subVectors(y,x),E.y>0?N(M()):E.y<0&&I(M()),x.copy(y),i.update()}(t);break;case n.PAN:if(!1===i.enablePan)return;!function(t){w.set(t.clientX,t.clientY),_.subVectors(w,f).multiplyScalar(i.panSpeed),T(_.x,_.y),f.copy(w),i.update()}(t)}}(t))}function H(t){!1!==i.enabled&&(t.pointerType,i.dispatchEvent(p),s=n.NONE,Z(t),0===C.length&&(i.domElement.ownerDocument.removeEventListener("pointermove",q),i.domElement.ownerDocument.removeEventListener("pointerup",H)))}function B(t){Z(t)}function Y(t){!1===i.enabled||!1===i.enableZoom||s!==n.NONE&&s!==n.ROTATE||(t.preventDefault(),i.dispatchEvent(h),function(t){t.deltaY<0?I(M()):t.deltaY>0&&N(M()),i.update()}(t),i.dispatchEvent(p))}function U(t){!1!==i.enabled&&!1!==i.enablePan&&function(t){let e=!1;switch(t.code){case i.keys.UP:T(0,i.keyPanSpeed),e=!0;break;case i.keys.BOTTOM:T(0,-i.keyPanSpeed),e=!0;break;case i.keys.LEFT:T(i.keyPanSpeed,0),e=!0;break;case i.keys.RIGHT:T(-i.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),i.update())}(t)}function $(t){!1!==i.enabled&&t.preventDefault()}function Z(t){delete P[t.pointerId];for(let e=0;e<C.length;e++)if(C[e].pointerId==t.pointerId)return void C.splice(e,1)}function X(t){let e=P[t.pointerId];void 0===e&&(e=new l.fG,P[t.pointerId]=e),e.set(t.pageX,t.pageY)}function W(t){const e=t.pointerId===C[0].pointerId?C[1]:C[0];return P[e.pointerId]}i.domElement.addEventListener("contextmenu",$),i.domElement.addEventListener("pointerdown",R),i.domElement.addEventListener("pointercancel",B),i.domElement.addEventListener("wheel",Y,{passive:!1}),this.update()}}let d,v,m,b,g={};const f=()=>{if(0!=g.length)for(let t in g){let e=g[t].material;e.uniforms.maxIterations.value=P.maxIterations,e.uniforms.scale.value=P.scale}},w=(t,e,i,n)=>{let s=g[t].material;function r(t,e){e<i&&(t.value.x=n[e].re,t.value.y=n[e].im)}s.uniforms.an.value=e,s.uniforms.nl.value=i,s.uniforms.maxIterations.value=P.maxIterations,r(s.uniforms.l1,0),r(s.uniforms.l2,1),r(s.uniforms.l3,2),r(s.uniforms.l4,3),r(s.uniforms.l5,4),r(s.uniforms.l6,5),r(s.uniforms.l7,6),r(s.uniforms.l8,7),r(s.uniforms.l9,8),r(s.uniforms.l10,9),r(s.uniforms.l11,10),r(s.uniforms.l12,11),r(s.uniforms.l13,14),r(s.uniforms.l14,13),r(s.uniforms.l15,14),r(s.uniforms.l16,15),r(s.uniforms.l17,16),r(s.uniforms.l18,17),r(s.uniforms.l19,18),r(s.uniforms.l20,19),r(s.uniforms.l21,20),r(s.uniforms.l22,21),r(s.uniforms.l23,22),r(s.uniforms.l24,23),r(s.uniforms.l25,24),r(s.uniforms.l26,25),r(s.uniforms.l27,26),r(s.uniforms.l28,27),r(s.uniforms.l29,28),r(s.uniforms.l30,29),r(s.uniforms.l31,30),r(s.uniforms.l32,31)},_=()=>{const t=document.getElementById("resized");return[t.width,t.height]},x=(t,e,i,n,s)=>{if(g.length>0)return void((t,e)=>{for(let i in t)w(g[i],e[i],t[i].length,t[i])})(t,e);if(null==d)(()=>{const[t,e]=_();d=new l.fT({alpha:!0,depth:!1});const i=document.getElementById("fractal");d.setSize(t,e),i.appendChild(d.domElement),v=new l.d5(-1,1,1,-1,.1,10),b=new u(v,d.domElement),v.position.z=3})();else{const[t,e]=_();d.setSize(t,e)}let r=0;for(let t in n)n[t]>r&&(r=n[t]);m=new l.eA;for(let s in t){let o=t[s],a=e[s],c=i[s],h=n[s];const p=new l.dh(2,2);p.translate(0,0,h/r*-.1);const u=new l.eE({uniforms:{an:{value:a},nl:{value:o.length},time:{value:0},maxIterations:{value:64},scale:{value:1},origin:{value:new l.fG(c.re,c.im)},l1:{value:new l.fG},l2:{value:new l.fG},l3:{value:new l.fG},l4:{value:new l.fG},l5:{value:new l.fG},l6:{value:new l.fG},l7:{value:new l.fG},l8:{value:new l.fG},l9:{value:new l.fG},l10:{value:new l.fG},l11:{value:new l.fG},l12:{value:new l.fG},l13:{value:new l.fG},l14:{value:new l.fG},l15:{value:new l.fG},l16:{value:new l.fG},l17:{value:new l.fG},l18:{value:new l.fG},l19:{value:new l.fG},l20:{value:new l.fG},l21:{value:new l.fG},l22:{value:new l.fG},l23:{value:new l.fG},l24:{value:new l.fG},l25:{value:new l.fG},l26:{value:new l.fG},l27:{value:new l.fG},l28:{value:new l.fG},l29:{value:new l.fG},l30:{value:new l.fG},l31:{value:new l.fG},l32:{value:new l.fG}},vertexShader:"\n    varying vec3 vUv;\n    \n    void main() {\n        vUv = position;\n\n        vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n        gl_Position = projectionMatrix * modelViewPosition;    }\n    ",fragmentShader:"\n    uniform float an;\n    uniform int nl;\n    uniform float time;\n    uniform int maxIterations;\n    uniform float scale;\n    uniform vec2 origin;\n\n    uniform vec2 l1;\n    uniform vec2 l2;\n    uniform vec2 l3;\n    uniform vec2 l4;\n    uniform vec2 l5;\n    uniform vec2 l6;\n    uniform vec2 l7;\n    uniform vec2 l8;\n    uniform vec2 l9;\n    uniform vec2 l10;\n    uniform vec2 l11;\n    uniform vec2 l12;\n    uniform vec2 l13;\n    uniform vec2 l14;\n    uniform vec2 l15;\n    uniform vec2 l16;\n    uniform vec2 l17;\n    uniform vec2 l18;\n    uniform vec2 l19;\n    uniform vec2 l20;\n    uniform vec2 l21;\n    uniform vec2 l22;\n    uniform vec2 l23;\n    uniform vec2 l24;\n    uniform vec2 l25;\n    uniform vec2 l26;\n    uniform vec2 l27;\n    uniform vec2 l28;\n    uniform vec2 l29;\n    uniform vec2 l30;\n    uniform vec2 l31;\n    uniform vec2 l32;\n    \n    varying vec3 vUv;\n\n    // from https://stackoverflow.com/questions/4200224/random-noise-functions-for-glsl\n\n    // A single iteration of Bob Jenkins' One-At-A-Time hashing algorithm.\n    uint hash( uint x ) {\n        x += ( x << 10u );\n        x ^= ( x >>  6u );\n        x += ( x <<  3u );\n        x ^= ( x >> 11u );\n        x += ( x << 15u );\n        return x;\n    }\n\n    // Construct a float with half-open range [0:1] using low 23 bits.\n    // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.\n    float floatConstruct( uint m ) {\n        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask\n        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32\n\n        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)\n        m |= ieeeOne;                          // Add fractional part to 1.0\n\n        float  f = uintBitsToFloat( m );       // Range [1:2]\n        return f - 1.0;                        // Range [0:1]\n    }\n\n    // Pseudo-random value in half-open range [0:1].\n    float random( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }\n\n    vec2 lejaStep(vec2 z, vec2 p, vec2 l, int n) {\n        if (n > nl) return p;\n        vec2 r = vec2(z.x-l.x, z.y-l.y);\n        vec2 p2 = vec2(p.x * r.x - p.y * r.y, p.x * r.y + p.y * r.x);\n        return p2;\n    }\n\n    vec2 P(vec2 z) {\n        vec2 p = vec2(z.x - l1.x,z.y - l1.y);\n        \n        p = lejaStep(z,p,l2,2);\n        p = lejaStep(z,p,l3,3);\n        p = lejaStep(z,p,l4,4);\n        p = lejaStep(z,p,l5,5);\n        p = lejaStep(z,p,l6,6);\n        p = lejaStep(z,p,l7,7);\n        p = lejaStep(z,p,l8,8);\n        p = lejaStep(z,p,l9,9);\n        p = lejaStep(z,p,l10,10);\n        p = lejaStep(z,p,l11,11);\n        p = lejaStep(z,p,l12,12);\n        p = lejaStep(z,p,l13,13);\n        p = lejaStep(z,p,l14,14);\n        p = lejaStep(z,p,l15,15);\n        p = lejaStep(z,p,l16,16);\n        p = lejaStep(z,p,l17,17);\n        p = lejaStep(z,p,l18,18);\n        p = lejaStep(z,p,l19,19);\n        p = lejaStep(z,p,l20,20);\n        p = lejaStep(z,p,l21,21);\n        p = lejaStep(z,p,l22,22);\n        p = lejaStep(z,p,l23,23);\n        p = lejaStep(z,p,l24,24);\n        p = lejaStep(z,p,l25,25);\n        p = lejaStep(z,p,l26,26);\n        p = lejaStep(z,p,l27,27);\n        p = lejaStep(z,p,l28,28);\n        p = lejaStep(z,p,l29,29);\n        p = lejaStep(z,p,l30,30);\n        p = lejaStep(z,p,l31,31);\n        p = lejaStep(z,p,l32,32);\n\n        float scale = exp(0.5) / an;\n        return vec2(p.x*z.x - p.y*z.y, p.x*z.y + p.y*z.x) * scale;\n        \n    }\n\n    vec3 hsv2rgb(vec3 c)\n    {\n        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n\n    void main() {\n        vec2 z = (vec2(vUv.x, -vUv.y) - origin) / (scale + 0.1 * sin(0.025 * time));\n        float len = 0.0;\n        int iterations = 0;\n        for (;iterations < maxIterations; iterations++) {\n            if (length(z) > 2.0) {\n                break;\n            }\n            vec2 tmp = P(z);\n            len += length(z - tmp);\n            z = tmp;\n        }\n        float h =  0.5 * sin(time * 0.01) + random(an + l1.y);//random(l2.y + l2.x);\n        float s = 0.65;\n        float v = float(iterations)/float(maxIterations);\n        float a = v - 0.3;\n        if (a < 0.1) {\n          discard;\n        }\n        gl_FragColor = vec4(hsv2rgb(vec3(h,s,v)), a);\n    }\n",depthTest:!1,depthWrite:!1,transparent:!0}),d=new l.cr(p,u);m.add(d),g[s]=d,w(s,a,o.length,o),console.log("updated uniforms")}!function t(){s.begin(),requestAnimationFrame(t);for(let t in g)g[t].material.uniforms.time.value+=.01;b.update(),d.render(m,v),s.end()}()};var y=(0,r.c)((function(t,e){r.a,function(t){class e{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(t){this.target=t}}class n extends i{constructor(t,e,i){super(t),this.value=e,this.presetKey=i}}function s(t){return null==t}const r={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class o{constructor(t){var e;this.message=null!==(e=r[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new o({type:"alreadydisposed"})}static notBindable(){return new o({type:"notbindable"})}static propertyNotFound(t){return new o({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new o({type:"shouldneverhappen"})}}class a{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];i&&i.forEach((t=>{t.handler(e)}))}}const l="tp";function c(t){return(e,i)=>[l,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function h(t){return t.rawValue}function p(t,e){var i,n;t.emitter.on("change",(i=h,n=e,t=>n(i(t)))),e(t.rawValue)}function u(t,e,i){p(t.value(e),i)}function d(t,e){return i=>{!function(t,e,i){i?t.classList.add(e):t.classList.remove(e)}(t,e,i)}}const v=c("btn");class m{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(v()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(v("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");var s,r;n.classList.add(v("t")),s=e.props.value("title"),r=n,p(s,(t=>{r.textContent=null!=t?t:""})),this.buttonElement.appendChild(n)}}class b{constructor(t,e){this.emitter=new a,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new m(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class g{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new a,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){const e=this.constraint_?this.constraint_.constrain(t):t;!this.equals_(this.rawValue_,e)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=e,this.emitter.emit("change",{rawValue:e,sender:this}))}}class f{constructor(t){this.emitter=new a,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.value_!==t&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{sender:this,rawValue:this.value_}))}}function w(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new g(t,e):new f(t)}class _{constructor(t){this.emitter=new a,this.valMap_=t;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",(()=>{this.emitter.emit("change",{key:t,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:w(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new _(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function x(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function y(t){return{custom:e=>x(e)(t),boolean:x((t=>"boolean"==typeof t?t:void 0))(t),number:x((t=>"number"==typeof t?t:void 0))(t),string:x((t=>"string"==typeof t?t:void 0))(t),function:x((t=>"function"==typeof t?t:void 0))(t),constant:e=>x((t=>t===e?e:void 0))(t),raw:x((t=>t))(t),object:e=>x((t=>{if(null!==(i=t)&&"object"==typeof i)return function(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}(t,e);var i}))(t),array:e=>x((t=>{if(Array.isArray(t))return i=e,t.reduce(((t,e)=>{if(void 0===t)return;const n=i(e);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[]);var i}))(t)}}const E={optional:y(!0),required:y(!1)};function C(t,e){const i=E.required.object(e)(t);return i.succeeded?i.value:void 0}const P=c(""),M={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class k{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((t=>{e.classList.remove(P(void 0,M[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(P(void 0,M[t]))}))})),this.viewProps.handleDispose((()=>{!function(t){t&&t.parentElement&&t.parentElement.removeChild(t)}(e)}))}get parent(){return this.parent_}}const z="http://www.w3.org/2000/svg";function V(t){t.offsetHeight}function L(t){return void 0!==t.ontouchstart}const T=c("lbl");class N{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(T()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(T("l")),u(e.props,"label",(e=>{s(e)?this.element.classList.add(T(void 0,"nol")):(this.element.classList.remove(T(void 0,"nol")),function(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}(i),i.appendChild(function(t,e){const i=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,n)=>{n>0&&i.appendChild(t.createElement("br")),i.appendChild(e)})),i}(t,e)))})),this.element.appendChild(i),this.labelElement=i;const n=t.createElement("div");n.classList.add(T("v")),this.element.appendChild(n),this.valueElement=n}}class I extends k{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new N(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class S extends k{constructor(t){super(t),this.value=t.value}}class j extends _{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=_.createCore(e);return new j(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?`${t}px`:"auto"}bindExpandedClass(t,e){u(this,"expanded",(()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}}function O(t,e){e.style.height=t.styleHeight}function D(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),s(t.get("expandedHeight"))&&t.set("expandedHeight",function(t,e){let i=0;return function(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),V(e),i=e.clientHeight,t.set("temporaryExpanded",null),V(e)})),i}(t,e)),t.set("shouldFixHeight",!0),V(e)})),t.emitter.on("change",(()=>{O(t,e)})),O(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}class A{constructor(t,e){const i=c(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}class K extends S{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new N(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const G=c("");function F(t,e){return d(t,G(void 0,e))}class R extends _{constructor(t){super(t)}static create(t){var e,i;const n=null!=t?t:{},s={disabled:null!==(e=n.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=n.hidden)&&void 0!==i&&i},r=_.createCore(s);return new R(r)}bindClassModifiers(t){u(this,"disabled",F(t,"disabled")),u(this,"hidden",F(t,"hidden"))}bindDisabled(t){u(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){u(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}}class q{constructor(){this.disabled=!1,this.emitter=new a}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class H{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new a,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class B{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function Y(t,e){if(t instanceof e)return t;if(t instanceof B){const i=t.constraints.reduce(((t,i)=>t||(i instanceof e?i:null)),null);if(i)return i}return null}class U{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let e=t;return s(this.minValue)||(e=Math.max(e,this.minValue)),s(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}class ${constructor(t){this.step=t}constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}const Z=c("pop");class X{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Z()),e.viewProps.bindClassModifiers(this.element),p(e.shows,d(this.element,Z(void 0,"v")))}}class W{constructor(t,e){this.shows=w(!1),this.viewProps=e.viewProps,this.view=new X(t,{shows:this.shows,viewProps:this.viewProps})}}const Q=c("txt");class J{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Q()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(Q("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class tt{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new J(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=i),this.view.refresh()}}class et{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const it={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class nt{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=it[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const st={"+":t=>t,"-":t=>-t,"~":t=>~t};class rt{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=st[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ot(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function at(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function lt(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function ct(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=function(t,e){const i=lt(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=lt(t,e+=1);return""===s?"":n+s}(t,e);return""===n?"":i+n}function ht(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=function(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}(t,e);return e+=n.length,""===n?"":n+lt(t,e)}const pt=ot([function(t,e){const i=ht(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=lt(t,e);return i+n+s+ct(t,e+=s.length)},function(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=lt(t,e);return e+=n.length,""===n?"":i+n+ct(t,e)},function(t,e){const i=ht(t,e);return e+=i.length,""===i?"":i+ct(t,e)}]);const ut=ot([function(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=function(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(t,e);return""===n?"":i+n},function(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=function(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(t,e);return""===n?"":i+n},function(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=function(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}(t,e);return""===n?"":i+n}]),dt=ot([ut,pt]);function vt(t,e){return function(t,e){const i=dt(t,e);return e+=i.length,""===i?null:{evaluable:new et(i),cursor:e}}(t,e)||function(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=gt(t,e);if(!n)return null;e=n.cursor,e+=at(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}(t,e)}function mt(t,e,i){i+=at(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=at(e,i).length,operator:n}):null}const bt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>function(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let r=s.evaluable;for(;;){const s=mt(e,i,n);if(!s)break;n=s.cursor;const o=t(i,n);if(!o)return null;n=o.cursor,r=new nt(s.operator,r,o.evaluable)}return r?{cursor:n,evaluable:r}:null}}(t,e)),(function t(e,i){const n=vt(e,i);if(n)return n;const s=e.substr(i,1);if(i+=s.length,"+"!==s&&"-"!==s&&"~"!==s)return null;const r=t(e,i);return r?{cursor:i=r.cursor,evaluable:new rt(s,r.evaluable)}:null}));function gt(t,e){return e+=at(t,e).length,bt(t,e)}function ft(t){var e;const i=function(t){const e=gt(t,0);return e?e.cursor+at(t,e.cursor).length!==t.length?null:e.evaluable:null}(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function wt(t){if("number"==typeof t)return t;if("string"==typeof t){const e=ft(t);if(!s(e))return e}return 0}function _t(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function xt(t,e){for(;t.length<e;)t.push(void 0)}function yt(t){const e=[];return xt(e,t),w(e)}function Et(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function Ct({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function r(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(()=>{r((()=>{e.rawValue=i(t,e)}))})),e.emitter.on("change",(()=>{r((()=>{t.rawValue=n(t,e)})),r((()=>{e.rawValue=i(t,e)}))})),r((()=>{e.rawValue=i(t,e)}))}function Pt(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function Mt(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function kt(t,e){const i=e.ownerDocument.defaultView,n=e.getBoundingClientRect();return{x:t.pageX-((i&&i.scrollX||0)+n.left),y:t.pageY-((i&&i.scrollY||0)+n.top)}}class zt{constructor(t){this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new a,t.addEventListener("touchstart",this.onTouchStart_),t.addEventListener("touchmove",this.onTouchMove_),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}onTouchEnd_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Vt(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)}function Lt(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Tt(t,e,i){return Math.min(Math.max(t,e),i)}const Nt=c("txt");class It{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Nt(),Nt(void 0,"num")),e.arrayPosition&&this.element.classList.add(Nt(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Nt("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Nt()),this.inputElement.classList.add(Nt("i"));const n=t.createElement("div");n.classList.add(Nt("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(z,"svg");s.classList.add(Nt("g")),this.knobElement.appendChild(s);const r=t.createElementNS(z,"path");r.classList.add(Nt("gb")),s.appendChild(r),this.guideBodyElem_=r;const o=t.createElementNS(z,"path");o.classList.add(Nt("gh")),s.appendChild(o),this.guideHeadElem_=o;const a=t.createElement("div");a.classList.add(c("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(Nt(void 0,"drg"));this.element.classList.add(Nt(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=Tt(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class St{constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=w(null),this.view=new It(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_);const i=new zt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=i),this.view.refresh()}onInputKeyDown_(t){const e=Pt(this.baseStep_,Mt(t));0!==e&&(this.value.rawValue+=e)}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}onPointerMove_(t){if(!t.data.point)return;const e=t.data.point.x-t.data.bounds.width/2;this.value.rawValue=this.originRawValue_+e*this.props.get("draggingScale"),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_}onPointerUp_(){this.dragging_.rawValue=null}}function jt(t,e){t.write(e)}function Ot(t,e){const i=t&&Y(t,$);return i?Lt(i.step):Math.max(Lt(e),2)}function Dt(t){const e=function(t){const e=t?Y(t,$):null;return e?e.step:null}(t);return null!=e?e:1}function At(t,e){var i;const n=t&&Y(t,$),s=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}class Kt{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const Gt=c("pndtxt");class Ft{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Gt()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(Gt("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}class Rt{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>function(t,e,i){return new St(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:w(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}(t,e,n))),this.acs_.forEach(((t,i)=>{Ct({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new Ft(t,{textViews:this.acs_.map((t=>t.view))})}}const qt={defaultInterval:200,defaultLineCount:3};class Ht{constructor(){this.emitter=new a,this.index_=-1}get index(){return this.index_}set index(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}}const Bt=c("grl");class Yt{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Bt()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(z,"svg");i.classList.add(Bt("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(z,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const s=t.createElement("div");s.classList.add(Bt("t"),c("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.minValue_,n=this.maxValue_,s=[];this.value.rawValue.forEach(((r,o)=>{if(void 0===r)return;const a=Vt(o,0,e,0,t.width),l=Vt(r,i,n,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const r=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0===o)return void r.classList.remove(Bt("t","a"));const a=Vt(this.cursor_.index,0,e,0,t.width),l=Vt(o,i,n,t.height,0);r.style.left=`${a}px`,r.style.top=`${l}px`,r.textContent=`${this.formatter_(o)}`,r.classList.contains(Bt("t","a"))||(r.classList.add(Bt("t","a"),Bt("t","in")),V(r),r.classList.remove(Bt("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Ut{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.cursor_=new Ht,this.view=new Yt(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:this.viewProps}),L(t)){const t=new zt(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Vt(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.index=Math.floor(Vt(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}}class $t{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.emitter.on(t,(()=>{n(new i(this))})),this}}class Zt extends i{constructor(t,e,i){super(t),this.cell=e,this.index=i}}class Xt extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new a;const e=this.controller_.valueController;e.cellControllers.forEach(((t,i)=>{const n=new $t(t);this.cellToApiMap_.set(t,n),t.emitter.on("click",(()=>{const t=i%e.size[0],s=Math.floor(i/e.size[0]);this.emitter_.emit("click",{event:new Zt(this,n,[t,s])})}))}))}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class Wt{constructor(t,e){this.size=e.size;const[i,n]=this.size,s=[];for(let r=0;r<n;r++)for(let n=0;n<i;n++){const i=new b(t,{props:_.fromObject(Object.assign({},e.cellConfig(n,r))),viewProps:R.create()});s.push(i)}this.cellCs_=s,this.viewProps=R.create(),this.viewProps.handleDispose((()=>{this.cellCs_.forEach((t=>{t.viewProps.set("disposed",!0)}))})),this.view=new A(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}}const Qt={id:"buttongrid",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept(t){const e=E,i=C(t,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new I(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:new Wt(t.document,{cellConfig:t.params.cells,size:t.params.size})}),api:t=>t.controller instanceof I&&t.controller.valueController instanceof Wt?new Xt(t.controller):null};class Jt extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get value(){return this.controller_.valueController.value.rawValue}}function te(t,e,i){return t*(1-i)+e*i}function ee(t,e){let i=.25,n=.5,s=-1;for(let r=0;r<20;r++){const[r,o]=t.curve(n);if(n+=i*(r<e?1:-1),s=o,i*=.5,Math.abs(e-r)<.001)break}return s}class ie{constructor(t=0,e=0,i=1,n=1){this.cache_=[],this.comps_=[t,e,i,n]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return!s(t)&&!!Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=te(0,this.x1,t),i=te(0,this.y1,t),n=te(this.x1,this.x2,t),s=te(this.y1,this.y2,t),r=te(this.x2,1,t),o=te(this.y2,1,t),a=te(e,n,t),l=te(i,s,t),c=te(n,r,t),h=te(s,o,t);return[te(a,c,t),te(l,h,t)]}y(t){if(0===this.cache_.length){const t=[];for(let e=0;e<100;e++)t.push(ee(this,Vt(e,0,99,0,1)));this.cache_=t}return this.cache_[Math.round(Vt(Tt(t,0,1),0,1,0,99))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const ne={toComponents:t=>t.toObject(),fromComponents:t=>new ie(...t)};function se(t){const e=_t(2);return`cubic-bezier(${t.toObject().map((t=>e(t))).join(", ")})`}const re=[0,.5,.5,1];function oe(t){const e=t.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new ie(...re);const i=[e[1],e[2],e[3],e[4]].reduce(((t,e)=>{if(!t)return null;const i=Number(e);return isNaN(i)?null:[...t,i]}),[]);return new ie(...null!=i?i:re)}const ae=c("cbz");class le{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ae()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,ae(void 0,"expanded")),u(e.foldable,"completed",d(this.element,ae(void 0,"cpl")));const i=t.createElement("div");i.classList.add(ae("h")),this.element.appendChild(i);const n=t.createElement("button");n.classList.add(ae("b")),e.viewProps.bindDisabled(n);const s=t.createElementNS(z,"svg");s.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',n.appendChild(s),i.appendChild(n),this.buttonElement=n;const r=t.createElement("div");if(r.classList.add(ae("t")),i.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(ae("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const ce=c("cbzp");class he{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ce()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(ce("g")),this.element.appendChild(i),this.graphElement=i;const n=t.createElement("div");n.classList.add(ce("t")),this.element.appendChild(n),this.textElement=n}}function pe(t,e){const i=new MutationObserver((t=>{for(const n of t)"childList"===n.type&&n.addedNodes.forEach((t=>{t.contains(t)&&(e(),i.disconnect())}))})),n=t.ownerDocument;i.observe(n.body,{attributes:!0,childList:!0,subtree:!0})}const ue=c("cbzg");class de{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ue()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(ue("p")),this.element.appendChild(i),this.previewElement=i;const n=t.createElementNS(z,"svg");n.classList.add(ue("g")),this.element.appendChild(n),this.svgElem_=n;const s=t.createElementNS(z,"path");s.classList.add(ue("u")),this.svgElem_.appendChild(s),this.guideElem_=s;const r=t.createElementNS(z,"polyline");r.classList.add(ue("l")),this.svgElem_.appendChild(r),this.lineElem_=r,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach((t=>{t.classList.add(ue("h")),this.element.appendChild(t)})),this.vectorElems_=[t.createElementNS(z,"line"),t.createElementNS(z,"line")],this.vectorElems_.forEach((t=>{t.classList.add(ue("v")),this.svgElem_.appendChild(t)})),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach(((t,e)=>{var i,n;p(this.sel_,(i=t=>t===e,n=d(t,ue("h","sel")),t=>n(i(t))))})),pe(this.element,(()=>{this.refresh()}))}getVertMargin_(t){return.25*t}valueToPosition(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,r=this.getVertMargin_(s);return{x:Vt(t,0,1,0,n),y:Vt(e,0,1,s-r,r)}}positionToValue(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,r=this.getVertMargin_(s);return{x:Tt(Vt(t,0,n,0,1),0,1),y:Vt(e,s-r,r,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map((t=>{const e=this.valueToPosition(0,t),i=this.valueToPosition(1,t);return[`M ${e.x},${e.y}`,`L ${i.x},${i.y}`].join(" ")})).join(" "));const t=this.value_.rawValue,e=[];let i=0;for(;;){const n=this.valueToPosition(...t.curve(i));if(e.push([n.x,n.y].join(",")),i>=1)break;i=Math.min(i+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const n=t.toObject();[0,1].forEach((t=>{const e=this.valueToPosition(t,t),i=this.valueToPosition(n[2*t],n[2*t+1]),s=this.vectorElems_[t];s.setAttributeNS(null,"x1",String(e.x)),s.setAttributeNS(null,"y1",String(e.y)),s.setAttributeNS(null,"x2",String(i.x)),s.setAttributeNS(null,"y2",String(i.y));const r=this.handleElems_[t];r.style.left=`${i.x}px`,r.style.top=`${i.y}px`}))}onValueChange_(){this.refresh()}}const ve=c("cbzprv");class me{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ve()),e.viewProps.bindClassModifiers(this.element);const i=t.createElementNS(z,"svg");i.classList.add(ve("g")),this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(z,"path");n.classList.add(ve("t")),this.svgElem_.appendChild(n),this.ticksElem_=n;const s=t.createElement("div");s.classList.add(ve("m")),this.element.appendChild(s),this.markerElem_=s,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),pe(this.element,(()=>{this.refresh()}))}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(ve("m","a")),this.startTime_=(new Date).getTime()+400,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(ve("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(Tt(t,0,1));this.markerElem_.style.left=100*e+"%"}refresh(){const t=this.svgElem_.getBoundingClientRect(),e=t.width,i=t.height,n=[],s=this.value_.rawValue;for(let t=0;t<24;t++){const r=Vt(t,0,23,0,1),o=Vt(s.y(r),0,1,0,e);n.push(`M ${o},0 v${i}`)}this.ticksElem_.setAttributeNS(null,"d",n.join(" "))}onTimer_(){if(null===this.startTime_)return;const t=(new Date).getTime()-this.startTime_,e=t/1e3;this.updateMarker_(e),t>1400&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function be(t,e,i,n){const s=i-t,r=n-e;return Math.sqrt(s*s+r*r)}class ge{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=w(0),this.viewProps=e.viewProps,this.view=new de(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.prevView_=new me(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(t=>{t.stopImmediatePropagation(),t.preventDefault(),this.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);const i=new zt(this.view.element);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e){const i=this.sel_.rawValue,n=this.value.rawValue.toObject(),s=this.view.positionToValue(t.x,t.y),r=e?function(t,e,i,n){const s=be(t,e,i,n),r=Math.atan2(n-e,i-t),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:t+Math.cos(o)*s,y:e+Math.sin(o)*s}}(i,i,s.x,s.y):s;n[2*i]=r.x,n[2*i+1]=r.y,this.value.rawValue=new ie(...n)}onPointerDown_(t){const e=t.data;if(!e.point)return;const i=this.value.rawValue,n=this.view.valueToPosition(i.x1,i.y1),s=be(e.point.x,e.point.y,n.x,n.y),r=this.view.valueToPosition(i.x2,i.y2),o=be(e.point.x,e.point.y,r.x,r.y);this.sel_.rawValue=s<=o?0:1,this.updateValue_(e.point,t.shiftKey)}onPointerMove_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey)}onKeyDown_(t){var e;(function(t){return"ArrowUp"===t||"ArrowDown"===t}(e=t.key)||"ArrowLeft"===e||"ArrowRight"===e)&&t.preventDefault();const i=this.sel_.rawValue,n=this.value.rawValue.toObject();n[2*i]+=Pt(this.baseStep_,function(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}(t)),n[2*i+1]+=Pt(this.baseStep_,Mt(t)),this.value.rawValue=new ie(...n)}}class fe{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new he(t,{viewProps:this.viewProps}),this.gc_=new ge(t,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const i=Object.assign(Object.assign({},e.axis),{constraint:new U({max:1,min:0})}),n=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new Rt(t,{assembly:ne,axes:[i,n,i,n],parser:ft,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map((t=>t.inputElement))]}refresh(){this.gc_.refresh()}}class we{constructor(t,e){var i;this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=(i=e.expanded,j.create(i)),this.view=new le(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new tt(t,{parser:oe,props:_.fromObject({formatter:se}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===e.pickerLayout?new W(t,{viewProps:this.viewProps}):null;const n=new fe(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),p(this.popC_.shows,(t=>{t&&n.refresh()})),Ct({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),D(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;e&&this.popC_.view.element.contains(e)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=function(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!L(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_&&"Escape"===t.key&&(this.popC_.shows.rawValue=!1)}}const _e={id:"cubic-bezier",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept(t){const e=E,i=C(t,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((t=>"inline"===t||"popup"===t?t:void 0))});return i?{params:i}:null},controller(t){var e,i;const n=w(new ie(...t.params.value),{constraint:new Kt({assembly:ne,components:[0,1,2,3].map((t=>t%2==0?new U({min:0,max:1}):void 0))}),equals:ie.equals}),s=new we(t.document,{axis:{baseStep:.1,textProps:_.fromObject({draggingScale:.01,formatter:_t(2)})},expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",value:n,viewProps:t.viewProps});return new K(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:s})},api:t=>t.controller instanceof K&&t.controller.valueController instanceof we?new Jt(t.controller):null};class xe extends e{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}class ye{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(0===this.timestamps_.length)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=20)return;const t=this.timestamps_.length-20;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach((t=>{t.frameCount-=e})),this.frameCount_-=e}end(t){if(null===this.start_)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const Ee=c("fps");class Ce{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ee()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(Ee("g")),this.element.appendChild(this.graphElement);const i=t.createElement("div");i.classList.add(Ee("l")),this.element.appendChild(i);const n=t.createElement("span");n.classList.add(Ee("v")),n.textContent="--",i.appendChild(n),this.valueElement=n;const s=t.createElement("span");s.classList.add(Ee("u")),s.textContent="FPS",i.appendChild(s)}}class Pe{constructor(t,e){this.stopwatch_=new ye,this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new Ce(t,{viewProps:this.viewProps}),this.graphC_=new Ut(t,{formatter:_t(0),lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()}))}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.stopwatch_.fps;if(null!==t){const e=this.value_.rawValue;this.value_.rawValue=function(t,e){const i=[...Et(t),e];return i.length>t.length?i.splice(0,i.length-t.length):xt(i,t.length),i}(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}function Me(t,e){return 0===e?new q:new H(t,null!=e?e:qt.defaultInterval)}const ke={id:"fpsgraph",type:"blade",accept(t){const e=E,i=C(t,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return i?{params:i}:null},controller(t){var e,i,n,s;const r=null!==(e=t.params.interval)&&void 0!==e?e:500;return new I(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:new Pe(t.document,{lineCount:null!==(i=t.params.lineCount)&&void 0!==i?i:2,maxValue:null!==(n=t.params.max)&&void 0!==n?n:90,minValue:null!==(s=t.params.min)&&void 0!==s?s:0,ticker:Me(t.document,r),value:yt(80),viewProps:t.viewProps})})},api:t=>t.controller instanceof I&&t.controller.valueController instanceof Pe?new xe(t.controller):null};class ze{constructor(t,e){this.min=t,this.max=e}static isObject(t){if("object"!=typeof t||null===t)return!1;const e=t.min,i=t.max;return"number"==typeof e&&"number"==typeof i}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Ve={fromComponents:t=>new ze(t[0],t[1]),toComponents:t=>[t.min,t.max]};class Le{constructor(t){this.edge=t}constrain(t){var e,i,n,s,r,o,a,l;if(t.min<=t.max)return new ze(null!==(i=null===(e=this.edge)||void 0===e?void 0:e.constrain(t.min))&&void 0!==i?i:t.min,null!==(s=null===(n=this.edge)||void 0===n?void 0:n.constrain(t.max))&&void 0!==s?s:t.max);const c=(t.min+t.max)/2;return new ze(null!==(o=null===(r=this.edge)||void 0===r?void 0:r.constrain(c))&&void 0!==o?o:c,null!==(l=null===(a=this.edge)||void 0===a?void 0:a.constrain(c))&&void 0!==l?l:c)}}const Te=c("rsltxt");class Ne{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(Te());const i=t.createElement("div");i.classList.add(Te("s")),i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Te("t")),n.appendChild(this.textView_.element),this.element.appendChild(n)}}const Ie=c("rsl");class Se{constructor(t,e){this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.element=t.createElement("div"),this.element.classList.add(Ie()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this));const i=t.createElement("div");i.classList.add(Ie("t")),this.element.appendChild(i),this.trackElement=i;const n=t.createElement("div");n.classList.add(Ie("b")),i.appendChild(n),this.barElement=n;const s=["min","max"].map((e=>{const n=t.createElement("div");return n.classList.add(Ie("k"),Ie("k",e)),i.appendChild(n),n}));this.knobElements=[s[0],s[1]],this.update()}valueToX_(t){return 100*Tt(Vt(t,this.minValue_,this.maxValue_,0,1),0,1)}update(){const t=this.value_.rawValue;0===t.length?this.element.classList.add(Ie(void 0,"zero")):this.element.classList.remove(Ie(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=100-e[1]+"%",this.knobElements.forEach(((t,i)=>{t.style.left=`${e[i]}%`}))}onValueChange_(){this.update()}}class je{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.viewProps=e.viewProps,this.value=e.value,this.view=new Se(t,{maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:e.viewProps});const i=new zt(this.view.trackElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}ofs_(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){return t.point?Vt((t.point.x+this.ofs_())/t.bounds.width,0,1,this.minValue_,this.maxValue_):null}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,i=this.value.rawValue,n=Vt(i.min,this.minValue_,this.maxValue_,0,1),s=Vt(i.max,this.minValue_,this.maxValue_,0,1);Math.abs(s-e)<=.025?this.grabbing_="max":Math.abs(n-e)<=.025?this.grabbing_="min":e>=n&&e<=s?(this.grabbing_="length",this.grabOffset_=Vt(e-n,0,1,this.minValue_,this.maxValue_)):e<n?(this.grabbing_="min",this.onPointerMove_(t)):e>s&&(this.grabbing_="max",this.onPointerMove_(t))}onPointerMove_(t){const e=this.valueFromData_(t.data);if(null!==e)if("min"===this.grabbing_)this.value.rawValue=new ze(e,this.value.rawValue.max);else if("max"===this.grabbing_)this.value.rawValue=new ze(this.value.rawValue.min,e);else if("length"===this.grabbing_){const t=this.value.rawValue.length;let i=e-this.grabOffset_,n=i+t;i<this.minValue_?(i=this.minValue_,n=this.minValue_+t):n>this.maxValue_&&(i=this.maxValue_-t,n=this.maxValue_),this.value.rawValue=new ze(i,n)}}onPointerUp_(t){this.grabbing_=null}}class Oe{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new je(t,e);const i={baseStep:e.baseStep,constraint:e.constraint,textProps:_.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new Rt(t,{assembly:Ve,axes:[i,i],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new Ne(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function De(t){return ze.isObject(t)?new ze(t.min,t.max):new ze(0,0)}function Ae(t,e){t.writeProperty("max",e.max),t.writeProperty("min",e.min)}function Ke(t){const e=[],i=function(t){return"max"in t&&!s(t.max)||"min"in t&&!s(t.min)?new U({max:t.max,min:t.min}):null}(t);i&&e.push(i);const n=function(t){return"step"in t&&!s(t.step)?new $(t.step):null}(t);return n&&e.push(n),new Le(new B(e))}const Ge={id:"input-interval",type:"input",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:(t,e)=>{if(!ze.isObject(t))return null;const i=E,n=C(e,{max:i.optional.number,min:i.optional.number,step:i.optional.number});return n?{initialValue:new ze(t.min,t.max),params:n}:null},binding:{reader:t=>De,constraint:t=>Ke(t.params),equals:ze.equals,writer:t=>Ae},controller(t){const e=t.value,i=t.constraint;if(!(i instanceof Le))throw o.shouldNeverHappen();const n=(e.rawValue.min+e.rawValue.max)/2,s=i.edge&&Y(i.edge,U);if(void 0!==(null==s?void 0:s.minValue)&&void 0!==(null==s?void 0:s.maxValue))return new Oe(t.document,{baseStep:Dt(i.edge),constraint:i.edge,draggingScale:At(s,n),formatter:_t(Ot(i.edge,n)),maxValue:s.maxValue,minValue:s.minValue,parser:ft,value:e,viewProps:t.viewProps});const r={baseStep:Dt(i.edge),constraint:i.edge,textProps:_.fromObject({draggingScale:n,formatter:_t(Ot(i.edge,n))})};return new Rt(t.document,{assembly:Ve,axes:[r,r],parser:ft,value:e,viewProps:t.viewProps})}};class Fe{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}}class Re extends n{constructor(t,e,i,n,s){super(t,n,s),this.cell=e,this.index=i}}class qe extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach((t=>{const e=new Fe(t);this.cellToApiMap_.set(t,e)}))}get value(){return this.controller_.value}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);this.controller_.value.emitter.on(t,(t=>{const e=this.controller_.valueController,n=e.findCellByValue(t.rawValue);if(!n)return;const s=this.cellToApiMap_.get(n);if(!s)return;const r=e.cellControllers.indexOf(n);i(new Re(this,s,[r%e.size[0],Math.floor(r/e.size[0])],t.rawValue,void 0))}))}}const He=c("rad");class Be{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(He()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(He("l")),this.element.appendChild(i);const n=t.createElement("input");n.classList.add(He("i")),n.name=e.name,n.type="radio",e.viewProps.bindDisabled(n),i.appendChild(n),this.inputElement=n;const s=t.createElement("div");s.classList.add(He("b")),i.appendChild(s);const r=t.createElement("div");r.classList.add(He("t")),s.appendChild(r),u(e.props,"title",(t=>{r.textContent=t}))}}class Ye{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Be(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class Ue{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[i,n]=this.size;for(let s=0;s<n;s++)for(let n=0;n<i;n++){const i=new Ye(t,{name:e.groupName,props:_.fromObject(Object.assign({},e.cellConfig(n,s))),viewProps:R.create()});this.cellCs_.push(i),this.cellValues_.push(e.cellConfig(n,s).value)}this.value=e.value,p(this.value,(t=>{const e=this.findCellByValue(t);e&&(e.view.inputElement.checked=!0)})),this.viewProps=R.create(),this.view=new A(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{t.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex((e=>e===t));return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,i=this.cellCs_.findIndex((t=>t.view.inputElement===e));i<0||(this.value.rawValue=this.cellValues_[i])}}const $e=[Qt,_e,ke,Ge,{id:"radiogrid",type:"blade",accept(t){const e=E,i=C(t,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new K(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:new Ue(t.document,{groupName:t.params.groupName,cellConfig:t.params.cells,size:t.params.size,value:w(t.params.value)})}),api:t=>t.controller instanceof K&&t.controller.valueController instanceof Ue?new qe(t.controller):null},{id:"input-radiogrid",type:"input",accept(t,e){if("number"!=typeof t)return null;const i=E,n=C(e,{cells:i.required.function,groupName:i.required.string,size:i.required.array(i.required.number),view:i.required.constant("radiogrid")});return n?{initialValue:t,params:n}:null},binding:{reader:t=>wt,writer:t=>jt},controller:t=>new Ue(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}];t.plugins=$e,Object.defineProperty(t,"__esModule",{value:!0})}(e)}));const E=(0,r.g)(y);var C=y.plugins;const P={outputSize:260,minClusterSize:.01,numColors:4,numValidSubsets:"",edgePoints:"",scale:1,origin:{x:0,y:0},numLejaPoints:32,maxIterations:4},M=(t,e,i)=>{if(0==t.length)return e[i].abs();var n=1;for(let s=0;s<t.length;s++)n*=e[i].sub(t[s]).abs();return n},k=t=>{let e=1;for(let i=0;i<t.length-1;i++)e*=t[t.length-1].sub(t[i]).abs();return e},z=t=>{let e=0,i=0;for(let n=0;n<t.length;n++){let s=t[n];e+=s.re,i+=s.im}return e/=t.length,i/=t.length,new o(e,i)},V=async t=>{const e=document.getElementById("resized").getContext("2d"),i=URL.createObjectURL(t),n=await(r=i,new Promise((t=>{const e=document.getElementById("resized"),i=e.getContext("2d"),n=new Image;n.onload=()=>{let s=Math.max(n.width,n.height),r=Math.floor(n.width*(P.outputSize/s)),o=Math.floor(n.height*(P.outputSize/s));e.width=r,e.height=o,i.drawImage(n,0,0,n.width,n.height,0,0,r,o),t({width:r,height:o})},n.src=r})));var r;const a=document.getElementById("fractal");a.style.width=n.width,a.style.height=n.height;let l=new s.es("uint8",[n.width,n.height,4]);const c=e.getImageData(0,0,n.width,n.height);for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++){let i=4*(t+e*n.width);for(let n=0;n<4;n++)l.set(t,e,n,c.data[i+n])}console.log(c),console.log(l);let h=l;h=s.Ig(h,P.numColors);const p=s.He(h),u=new s.z_;u.init(h),u.runOp(h,0,p),u.destroy();var d=new s.es("uint8",[n.width,n.height]);function v(t,e,i){return t<n.width&&t>=0&&e<n.height&&e>=0&&d.get(t,e)!=i}function m(t,e){var i=[t];let n,s,r=0;for(;i.length>0;)[n,s]=i.pop(),d.set(n,s,e),r++,v(n-1,s,e)&&p.get(n-1,s,0)==p.get(n,s,0)&&i.push([n-1,s]),v(n,s-1,e)&&p.get(n,s-1,0)==p.get(n,s,0)&&i.push([n,s-1]),v(n+1,s,e)&&p.get(n+1,s,0)==p.get(n,s,0)&&i.push([n+1,s]),v(n,s+1,e)&&p.get(n,s+1,0)==p.get(n,s,0)&&i.push([n,s+1]);return r}function b(t,e){for(let i=0;i<n.width;i++)for(let s=0;s<n.height;s++)d.get(i,s)==t&&d.set(i,s,e)}var g=0,f={};for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)if(0==d.get(t,e)){let i=m([t,e],255);i>P.minClusterSize*P.outputSize*P.outputSize&&(b(255,++g),f[g]=i)}P.numValidSubsets=g;var w=d.clone();for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++){let i=d.get(t,e);255!=i&&d.get(t-1,e)==i&&d.get(t+1,e)==i&&d.get(t,e-1)==i&&d.get(t,e+1)==i&&d.get(t-1,e-1)==i&&d.get(t+1,e-1)==i&&d.get(t-1,e+1)==i&&d.get(t+1,e+1)==i&&w.set(t,e,255)}e.fillStyle="rgba(255,255,255,0.85)";for(let t=0;t<n.width;t++)for(let i=0;i<n.height;i++)if(255!=w.get(t,i)){let n=d.get(t,i),s=Math.floor(80*Math.sin(n))+100,r=Math.floor(80*Math.cos(n+.5))+100,o=240-r;e.fillStyle=`rgb(${s},${o},${r})`,e.fillRect(t,i,1,1)}const[_,x]=(t=>{let e={};const[i,n,s]=t.shape,r=2/Math.max(i,n),a=new o(P.origin.x,P.origin.y);function l(t,e){let i=(t*r-1+a.re)*P.scale,n=(e*r-1+a.im)*P.scale;return new o(i,n)}let c=0,h={};for(let e=0;e<i-0;e++)for(let i=0;i<n-0;i++){let n=t.get(e,i);255!=n&&(c++,null!=h[n]?h[n].push(l(e,i)):h[n]=[l(e,i)])}let p=Math.floor(100*c/(i*n));P.complexPoints=`${c} / ${i*n} (${p}%)`;for(let t in h){let i=z(h[t]);e[t]=i;for(let e=0;e<h[t].length;e++)h[t][e]=h[t][e].sub(i)}return[h,e]})(w),y=(t=>{console.log(t);let e={};for(var i in t){const o=t[i],a=Math.min(P.numLejaPoints,Math.floor(o.length/2));let l=[];for(let t=0;t<a;t++){var n=0,s=0,r=0;for(let t=0;t<o.length;t++)(r=M(l,o,t))>n&&(n=r,s=t);l.push(o[s]),o.splice(s,1)}e[i]=l}return e})(_);return[y,(t=>{var e={};for(var i in t){let n=t[i];e[i]=k(n)}return e})(y),x,f]},[L,T]=(()=>{const t=new a.X({container:document.getElementById("settingsPanel"),title:"Parameters",expanded:!1});t.registerPlugin(n),P.outputSize=Math.floor(window.innerWidth/2)-64,t.addInput(P,"outputSize",{min:256,max:1024,step:1}),t.addInput(P,"minClusterSize",{min:.005,max:.4,step:.005}),t.addInput(P,"numColors",{min:2,max:16,step:1}),t.addInput(P,"numLejaPoints",{min:4,max:32,step:1}),t.addSeparator(),t.addInput(P,"maxIterations",{min:4,max:128,step:1}).on("change",(t=>{f()})),t.addInput(P,"scale",{min:.1,max:10,step:.1}).on("change",(t=>{f()})),t.addInput(P,"origin",{picker:"inline",expanded:!1}).on("change",(t=>{f()})),t.addSeparator(),t.addMonitor(P,"numValidSubsets"),t.addMonitor(P,"edgePoints"),t.addSeparator();const e=t.addBlade({view:"fpsgraph",label:"fpsgraph"});return[t,e]})();var N=document.getElementById("drop");N.addEventListener("dragover",(function(t){this.classList.add("dragging"),t.preventDefault()})),N.addEventListener("dragleave",(function(t){this.classList.remove("dragging"),t.preventDefault()})),N.addEventListener("drop",(async function(t){if(this.classList.remove("dragging"),t.preventDefault(),t.dataTransfer.items)for(var e=0;e<t.dataTransfer.items.length;e++)if("file"===t.dataTransfer.items[e].kind&&t.dataTransfer.items[e].type.match("^image/")){var i=t.dataTransfer.items[e].getAsFile();const[n,s,r,o]=await V(i);x(n,s,r,o,T)}}))}},t=>{"use strict";t.O(0,[949,962,325,807],(()=>(6887,t(t.s=6887)))),t.O()}]);