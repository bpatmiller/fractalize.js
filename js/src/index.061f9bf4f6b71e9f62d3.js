/*! For license information please see index.061f9bf4f6b71e9f62d3.js.LICENSE.txt */
(self.webpackChunkfractalize=self.webpackChunkfractalize||[]).push([[927],{3006:(t,e,i)=>{"use strict";i.d(e,{a:()=>n,b:()=>s,c:()=>r,g:()=>o});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function s(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e,i){return t(i={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&i.path)}},i.exports),i.exports}function o(t){return t&&Object.prototype.hasOwnProperty.call(t,"default")&&1===Object.keys(t).length?t.default:t}},8693:(t,e,i)=>{"use strict";i.d(e,{E:()=>L});var n={};i.r(n),i.d(n,{__moduleExports:()=>b,default:()=>g,plugins:()=>f});var s=i(4768),r=i(3006),o=(0,r.c)((function(t,e){!function(e){var i=function(t){return.5*(Math.exp(t)+Math.exp(-t))},n=function(t){return.5*(Math.exp(t)-Math.exp(-t))},s=function(){throw SyntaxError("Invalid Param")};function r(t,e){var i=Math.abs(t),n=Math.abs(e);return 0===t?Math.log(n):0===e?Math.log(i):i<3e3&&n<3e3?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}function o(t,e){if(!(this instanceof o))return new o(t,e);var i=function(t,e){var i={re:0,im:0};if(null==t)i.re=i.im=0;else if(void 0!==e)i.re=t,i.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)i.re=t.re,i.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return o.INFINITY;i.re=t.abs*Math.cos(t.arg),i.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return o.INFINITY;i.re=t.r*Math.cos(t.phi),i.im=t.r*Math.sin(t.phi)}else 2===t.length?(i.re=t[0],i.im=t[1]):s();break;case"string":i.im=i.re=0;var n=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),r=1,a=0;null===n&&s();for(var l=0;l<n.length;l++){var p=n[l];" "===p||"\t"===p||"\n"===p||("+"===p?r++:"-"===p?a++:"i"===p||"I"===p?(r+a===0&&s()," "===n[l+1]||isNaN(n[l+1])?i.im+=parseFloat((a%2?"-":"")+"1"):(i.im+=parseFloat((a%2?"-":"")+n[l+1]),l++),r=a=0):((r+a===0||isNaN(p))&&s(),"i"===n[l+1]||"I"===n[l+1]?(i.im+=parseFloat((a%2?"-":"")+p),l++):i.re+=parseFloat((a%2?"-":"")+p),r=a=0))}r+a>0&&s();break;case"number":i.im=0,i.re=t;break;default:s()}return i}(t,e);this.re=i.re,this.im=i.im}o.prototype={re:0,im:0,sign:function(){var t=this.abs();return new o(this.re/t,this.im/t)},add:function(t,e){var i=new o(t,e);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re+i.re,this.im+i.im)},sub:function(t,e){var i=new o(t,e);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re-i.re,this.im-i.im)},mul:function(t,e){var i=new o(t,e);return this.isInfinite()&&i.isZero()||this.isZero()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:0===i.im&&0===this.im?new o(this.re*i.re,0):new o(this.re*i.re-this.im*i.im,this.re*i.im+this.im*i.re)},div:function(t,e){var i=new o(t,e);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return o.NAN;if(this.isInfinite()||i.isZero())return o.INFINITY;if(this.isZero()||i.isInfinite())return o.ZERO;t=this.re,e=this.im;var n,s,r=i.re,a=i.im;return 0===a?new o(t/r,e/r):Math.abs(r)<Math.abs(a)?new o((t*(s=r/a)+e)/(n=r*s+a),(e*s-t)/n):new o((t+e*(s=a/r))/(n=a*s+r),(e-t*s)/n)},pow:function(t,e){var i=new o(t,e);if(t=this.re,e=this.im,i.isZero())return o.ONE;if(0===i.im){if(0===e&&t>0)return new o(Math.pow(t,i.re),0);if(0===t)switch((i.re%4+4)%4){case 0:return new o(Math.pow(e,i.re),0);case 1:return new o(0,Math.pow(e,i.re));case 2:return new o(-Math.pow(e,i.re),0);case 3:return new o(0,-Math.pow(e,i.re))}}if(0===t&&0===e&&i.re>0&&i.im>=0)return o.ZERO;var n=Math.atan2(e,t),s=r(t,e);return t=Math.exp(i.re*s-i.im*n),e=i.im*s+i.re*n,new o(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,i=this.re,n=this.im,s=this.abs();if(i>=0){if(0===n)return new o(Math.sqrt(i),0);t=.5*Math.sqrt(2*(s+i))}else t=Math.abs(n)/Math.sqrt(2*(s-i));return e=i<=0?.5*Math.sqrt(2*(s-i)):Math.abs(n)/Math.sqrt(2*(s+i)),new o(t,n<0?-e:e)},exp:function(){var t=Math.exp(this.re);return this.im,new o(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){var t=this.re,e=this.im;return new o(Math.expm1(t)*Math.cos(e)+function(t){var e=Math.PI/4;if(-e>t||t>e)return Math.cos(t)-1;var i=t*t;return i*(i*(i*(i*(i*(i*(i*(i/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this.re,e=this.im;return new o(r(t,e),Math.atan2(e,t))},abs:function(){return t=this.re,e=this.im,i=Math.abs(t),n=Math.abs(e),i<3e3&&n<3e3?Math.sqrt(i*i+n*n):(i<n?(i=n,n=t/e):n=e/t,i*Math.sqrt(1+n*n));var t,e,i,n},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new o(Math.sin(t)*i(e),Math.cos(t)*n(e))},cos:function(){var t=this.re,e=this.im;return new o(Math.cos(t)*i(e),-Math.sin(t)*n(e))},tan:function(){var t=2*this.re,e=2*this.im,s=Math.cos(t)+i(e);return new o(Math.sin(t)/s,n(e)/s)},cot:function(){var t=2*this.re,e=2*this.im,s=Math.cos(t)-i(e);return new o(-Math.sin(t)/s,n(e)/s)},sec:function(){var t=this.re,e=this.im,s=.5*i(2*e)+.5*Math.cos(2*t);return new o(Math.cos(t)*i(e)/s,Math.sin(t)*n(e)/s)},csc:function(){var t=this.re,e=this.im,s=.5*i(2*e)-.5*Math.cos(2*t);return new o(Math.sin(t)*i(e)/s,-Math.cos(t)*n(e)/s)},asin:function(){var t=this.re,e=this.im,i=new o(e*e-t*t+1,-2*t*e).sqrt(),n=new o(i.re-e,i.im+t).log();return new o(n.im,-n.re)},acos:function(){var t=this.re,e=this.im,i=new o(e*e-t*t+1,-2*t*e).sqrt(),n=new o(i.re-e,i.im+t).log();return new o(Math.PI/2-n.im,n.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new o(0,1/0);if(-1===e)return new o(0,-1/0)}var i=t*t+(1-e)*(1-e),n=new o((1-e*e-t*t)/i,-2*t/i).log();return new o(-.5*n.im,.5*n.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new o(Math.atan2(1,t),0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).atan():new o(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new o(0,1/0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).acos():new o(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new o(Math.PI/2,1/0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).asin():new o(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new o(n(t)*Math.cos(e),i(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new o(i(t)*Math.cos(e),n(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,s=i(t)+Math.cos(e);return new o(n(t)/s,Math.sin(e)/s)},coth:function(){var t=2*this.re,e=2*this.im,s=i(t)-Math.cos(e);return new o(n(t)/s,-Math.sin(e)/s)},csch:function(){var t=this.re,e=this.im,s=Math.cos(2*e)-i(2*t);return new o(-2*n(t)*Math.cos(e)/s,2*i(t)*Math.sin(e)/s)},sech:function(){var t=this.re,e=this.im,s=Math.cos(2*e)+i(2*t);return new o(2*i(t)*Math.cos(e)/s,-2*n(t)*Math.sin(e)/s)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t=this.acos();if(t.im<=0){var e=t.re;t.re=-t.im,t.im=e}else e=t.im,t.im=-t.re,t.re=e;return t},atanh:function(){var t=this.re,e=this.im,i=t>1&&0===e,n=1-t,s=1+t,a=n*n+e*e,l=0!==a?new o((s*n-e*e)/a,(e*n+s*e)/a):new o(-1!==t?t/0:0,0!==e?e/0:0),p=l.re;return l.re=r(l.re,l.im)/2,l.im=Math.atan2(l.im,p)/2,i&&(l.im=-l.im),l},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new o(0,Math.PI/2);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).atanh():new o(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new o(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).asinh():new o(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(this.isZero())return o.INFINITY;var i=t*t+e*e;return 0!==i?new o(t/i,-e/i).acosh():new o(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return o.INFINITY;if(this.isInfinite())return o.ZERO;var t=this.re,e=this.im,i=t*t+e*e;return new o(t/i,-e/i)},conjugate:function(){return new o(this.re,-this.im)},neg:function(){return new o(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new o(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new o(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new o(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){var i=new o(t,e);return Math.abs(i.re-this.re)<=o.EPSILON&&Math.abs(i.im-this.im)<=o.EPSILON},clone:function(){return new o(this.re,this.im)},toString:function(){var t=this.re,e=this.im,i="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<o.EPSILON&&(t=0),Math.abs(e)<o.EPSILON&&(e=0),0===e?i+t:(0!==t?(i+=t,i+=" ",e<0?(e=-e,i+="-"):i+="+",i+=" "):e<0&&(e=-e,i+="-"),1!==e&&(i+=e),i+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},o.ZERO=new o(0,0),o.ONE=new o(1,0),o.I=new o(0,1),o.PI=new o(Math.PI,0),o.E=new o(Math.E,0),o.INFINITY=new o(1/0,1/0),o.NAN=new o(NaN,NaN),o.EPSILON=1e-15,Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Complex=o,t.exports=o}()})).Complex,a=i(7715),l=i(9935);let p,h,c,u={};const d=()=>{if(0!=u.length)for(let t in u){let e=u[t].material;e.uniforms.maxIterations.value=w.maxIterations,e.uniforms.scale.value=w.scale}},v=(t,e,i,n)=>{let s=u[t].material;function r(t,e){e<i&&(t.value.x=n[e].re,t.value.y=n[e].im)}s.uniforms.an.value=e,s.uniforms.nl.value=i,s.uniforms.maxIterations.value=w.maxIterations,r(s.uniforms.l1,0),r(s.uniforms.l2,1),r(s.uniforms.l3,2),r(s.uniforms.l4,3),r(s.uniforms.l5,4),r(s.uniforms.l6,5),r(s.uniforms.l7,6),r(s.uniforms.l8,7),r(s.uniforms.l9,8),r(s.uniforms.l10,9),r(s.uniforms.l11,10),r(s.uniforms.l12,11),r(s.uniforms.l13,14),r(s.uniforms.l14,13),r(s.uniforms.l15,14),r(s.uniforms.l16,15),r(s.uniforms.l17,16),r(s.uniforms.l18,17),r(s.uniforms.l19,18),r(s.uniforms.l20,19),r(s.uniforms.l21,20),r(s.uniforms.l22,21),r(s.uniforms.l23,22),r(s.uniforms.l24,23),r(s.uniforms.l25,24),r(s.uniforms.l26,25),r(s.uniforms.l27,26),r(s.uniforms.l28,27),r(s.uniforms.l29,28),r(s.uniforms.l30,29),r(s.uniforms.l31,30),r(s.uniforms.l32,31),r(s.uniforms.l33,32),r(s.uniforms.l34,33),r(s.uniforms.l35,34),r(s.uniforms.l36,35),r(s.uniforms.l37,36),r(s.uniforms.l38,37),r(s.uniforms.l39,38),r(s.uniforms.l40,39),r(s.uniforms.l41,40),r(s.uniforms.l42,41),r(s.uniforms.l43,42),r(s.uniforms.l44,43),r(s.uniforms.l45,44),r(s.uniforms.l46,45),r(s.uniforms.l47,46),r(s.uniforms.l48,47),r(s.uniforms.l49,48),r(s.uniforms.l50,49),r(s.uniforms.l51,50),r(s.uniforms.l52,51),r(s.uniforms.l53,52),r(s.uniforms.l54,53),r(s.uniforms.l55,54),r(s.uniforms.l56,55),r(s.uniforms.l57,56),r(s.uniforms.l58,57),r(s.uniforms.l59,58),r(s.uniforms.l60,59),r(s.uniforms.l61,60),r(s.uniforms.l62,61),r(s.uniforms.l63,62),r(s.uniforms.l64,63)},m=()=>{const t=document.getElementById("source");return[Math.floor(t.width),Math.floor(t.height)]};var b=(0,r.c)((function(t,e){r.a,function(t){class e{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(t){this.target=t}}class n extends i{constructor(t,e,i){super(t),this.value=e,this.presetKey=i}}function s(t){return null==t}const r={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class o{constructor(t){var e;this.message=null!==(e=r[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new o({type:"alreadydisposed"})}static notBindable(){return new o({type:"notbindable"})}static propertyNotFound(t){return new o({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new o({type:"shouldneverhappen"})}}class a{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter((t=>t.handler!==e))),this}emit(t,e){const i=this.observers_[t];i&&i.forEach((t=>{t.handler(e)}))}}const l="tp";function p(t){return(e,i)=>[l,"-",t,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function h(t){return t.rawValue}function c(t,e){var i,n;t.emitter.on("change",(i=h,n=e,t=>n(i(t)))),e(t.rawValue)}function u(t,e,i){c(t.value(e),i)}function d(t,e){return i=>{!function(t,e,i){i?t.classList.add(e):t.classList.remove(e)}(t,e,i)}}const v=p("btn");class m{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(v()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(v("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=t.createElement("div");var s,r;n.classList.add(v("t")),s=e.props.value("title"),r=n,c(s,(t=>{r.textContent=null!=t?t:""})),this.buttonElement.appendChild(n)}}class b{constructor(t,e){this.emitter=new a,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new m(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class g{constructor(t,e){var i;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(i=null==e?void 0:e.equals)&&void 0!==i?i:(t,e)=>t===e,this.emitter=new a,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){const e=this.constraint_?this.constraint_.constrain(t):t;!this.equals_(this.rawValue_,e)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=e,this.emitter.emit("change",{rawValue:e,sender:this}))}}class f{constructor(t){this.emitter=new a,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.value_!==t&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{sender:this,rawValue:this.value_}))}}function w(t,e){const i=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return i||n?new g(t,e):new f(t)}class _{constructor(t){this.emitter=new a,this.valMap_=t;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",(()=>{this.emitter.emit("change",{key:t,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,i)=>Object.assign(e,{[i]:w(t[i])})),{})}static fromObject(t){const e=this.createCore(t);return new _(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function x(t){return e=>i=>{if(!e&&void 0===i)return{succeeded:!1,value:void 0};if(e&&void 0===i)return{succeeded:!0,value:void 0};const n=t(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function y(t){return{custom:e=>x(e)(t),boolean:x((t=>"boolean"==typeof t?t:void 0))(t),number:x((t=>"number"==typeof t?t:void 0))(t),string:x((t=>"string"==typeof t?t:void 0))(t),function:x((t=>"function"==typeof t?t:void 0))(t),constant:e=>x((t=>t===e?e:void 0))(t),raw:x((t=>t))(t),object:e=>x((t=>{if(null!==(i=t)&&"object"==typeof i)return function(t,e){return Object.keys(e).reduce(((i,n)=>{if(void 0===i)return;const s=(0,e[n])(t[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}(t,e);var i}))(t),array:e=>x((t=>{if(Array.isArray(t))return i=e,t.reduce(((t,e)=>{if(void 0===t)return;const n=i(e);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0}),[]);var i}))(t)}}const M={optional:y(!0),required:y(!1)};function C(t,e){const i=M.required.object(e)(t);return i.succeeded?i.value:void 0}const z=p(""),E={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class k{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((t=>{e.classList.remove(z(void 0,E[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(z(void 0,E[t]))}))})),this.viewProps.handleDispose((()=>{!function(t){t&&t.parentElement&&t.parentElement.removeChild(t)}(e)}))}get parent(){return this.parent_}}const P="http://www.w3.org/2000/svg";function V(t){t.offsetHeight}function S(t){return void 0!==t.ontouchstart}const L=p("lbl");class j{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(L()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(L("l")),u(e.props,"label",(e=>{s(e)?this.element.classList.add(L(void 0,"nol")):(this.element.classList.remove(L(void 0,"nol")),function(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}(i),i.appendChild(function(t,e){const i=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,n)=>{n>0&&i.appendChild(t.createElement("br")),i.appendChild(e)})),i}(t,e)))})),this.element.appendChild(i),this.labelElement=i;const n=t.createElement("div");n.classList.add(L("v")),this.element.appendChild(n),this.valueElement=n}}class I extends k{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new j(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class F extends k{constructor(t){super(t),this.value=t.value}}class N extends _{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=_.createCore(e);return new N(i)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?`${t}px`:"auto"}bindExpandedClass(t,e){u(this,"expanded",(()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}}function T(t,e){e.style.height=t.styleHeight}function D(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),s(t.get("expandedHeight"))&&t.set("expandedHeight",function(t,e){let i=0;return function(t,e){const i=t.style.transition;t.style.transition="none",e(),t.style.transition=i}(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),V(e),i=e.clientHeight,t.set("temporaryExpanded",null),V(e)})),i}(t,e)),t.set("shouldFixHeight",!0),V(e)})),t.emitter.on("change",(()=>{T(t,e)})),T(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}class O{constructor(t,e){const i=p(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}class K extends F{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new j(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const q=p("");function B(t,e){return d(t,q(void 0,e))}class A extends _{constructor(t){super(t)}static create(t){var e,i;const n=null!=t?t:{},s={disabled:null!==(e=n.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=n.hidden)&&void 0!==i&&i},r=_.createCore(s);return new A(r)}bindClassModifiers(t){u(this,"disabled",B(t,"disabled")),u(this,"hidden",B(t,"hidden"))}bindDisabled(t){u(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){u(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}}class ${constructor(){this.disabled=!1,this.emitter=new a}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class U{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new a,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class R{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function G(t,e){if(t instanceof e)return t;if(t instanceof R){const i=t.constraints.reduce(((t,i)=>t||(i instanceof e?i:null)),null);if(i)return i}return null}class H{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let e=t;return s(this.minValue)||(e=Math.max(e,this.minValue)),s(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}class Y{constructor(t){this.step=t}constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}const Z=p("pop");class X{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Z()),e.viewProps.bindClassModifiers(this.element),c(e.shows,d(this.element,Z(void 0,"v")))}}class J{constructor(t,e){this.shows=w(!1),this.viewProps=e.viewProps,this.view=new X(t,{shows:this.shows,viewProps:this.viewProps})}}const W=p("txt");class Q{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(W()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(W("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class tt{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Q(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=i),this.view.refresh()}}class et{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const it={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class nt{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=it[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const st={"+":t=>t,"-":t=>-t,"~":t=>~t};class rt{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=st[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ot(t){return(e,i)=>{for(let n=0;n<t.length;n++){const s=t[n](e,i);if(""!==s)return s}return""}}function at(t,e){var i;const n=t.substr(e).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function lt(t,e){var i;const n=t.substr(e).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function pt(t,e){const i=t.substr(e,1);if(e+=1,"e"!==i.toLowerCase())return"";const n=function(t,e){const i=lt(t,e);if(""!==i)return i;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const s=lt(t,e+=1);return""===s?"":n+s}(t,e);return""===n?"":i+n}function ht(t,e){const i=t.substr(e,1);if("0"===i)return i;const n=function(t,e){const i=t.substr(e,1);return i.match(/^[1-9]$/)?i:""}(t,e);return e+=n.length,""===n?"":n+lt(t,e)}const ct=ot([function(t,e){const i=ht(t,e);if(e+=i.length,""===i)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const s=lt(t,e);return i+n+s+pt(t,e+=s.length)},function(t,e){const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const n=lt(t,e);return e+=n.length,""===n?"":i+n+pt(t,e)},function(t,e){const i=ht(t,e);return e+=i.length,""===i?"":i+pt(t,e)}]);const ut=ot([function(t,e){const i=t.substr(e,2);if(e+=i.length,"0b"!==i.toLowerCase())return"";const n=function(t,e){var i;const n=t.substr(e).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(t,e);return""===n?"":i+n},function(t,e){const i=t.substr(e,2);if(e+=i.length,"0o"!==i.toLowerCase())return"";const n=function(t,e){var i;const n=t.substr(e).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(t,e);return""===n?"":i+n},function(t,e){const i=t.substr(e,2);if(e+=i.length,"0x"!==i.toLowerCase())return"";const n=function(t,e){var i;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}(t,e);return""===n?"":i+n}]),dt=ot([ut,ct]);function vt(t,e){return function(t,e){const i=dt(t,e);return e+=i.length,""===i?null:{evaluable:new et(i),cursor:e}}(t,e)||function(t,e){const i=t.substr(e,1);if(e+=i.length,"("!==i)return null;const n=gt(t,e);if(!n)return null;e=n.cursor,e+=at(t,e).length;const s=t.substr(e,1);return e+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:e}}(t,e)}function mt(t,e,i){i+=at(e,i).length;const n=t.filter((t=>e.startsWith(t,i)))[0];return n?(i+=n.length,{cursor:i+=at(e,i).length,operator:n}):null}const bt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>function(t,e){return(i,n)=>{const s=t(i,n);if(!s)return null;n=s.cursor;let r=s.evaluable;for(;;){const s=mt(e,i,n);if(!s)break;n=s.cursor;const o=t(i,n);if(!o)return null;n=o.cursor,r=new nt(s.operator,r,o.evaluable)}return r?{cursor:n,evaluable:r}:null}}(t,e)),(function t(e,i){const n=vt(e,i);if(n)return n;const s=e.substr(i,1);if(i+=s.length,"+"!==s&&"-"!==s&&"~"!==s)return null;const r=t(e,i);return r?{cursor:i=r.cursor,evaluable:new rt(s,r.evaluable)}:null}));function gt(t,e){return e+=at(t,e).length,bt(t,e)}function ft(t){var e;const i=function(t){const e=gt(t,0);return e?e.cursor+at(t,e.cursor).length!==t.length?null:e.evaluable:null}(t);return null!==(e=null==i?void 0:i.evaluate())&&void 0!==e?e:null}function wt(t){if("number"==typeof t)return t;if("string"==typeof t){const e=ft(t);if(!s(e))return e}return 0}function _t(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}function xt(t,e){for(;t.length<e;)t.push(void 0)}function yt(t){const e=[];return xt(e,t),w(e)}function Mt(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function Ct({primary:t,secondary:e,forward:i,backward:n}){let s=!1;function r(t){s||(s=!0,t(),s=!1)}t.emitter.on("change",(()=>{r((()=>{e.rawValue=i(t,e)}))})),e.emitter.on("change",(()=>{r((()=>{t.rawValue=n(t,e)})),r((()=>{e.rawValue=i(t,e)}))})),r((()=>{e.rawValue=i(t,e)}))}function zt(t,e){const i=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function Et(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function kt(t,e){const i=e.ownerDocument.defaultView,n=e.getBoundingClientRect();return{x:t.pageX-((i&&i.scrollX||0)+n.left),y:t.pageY-((i&&i.scrollY||0)+n.top)}}class Pt{constructor(t){this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new a,t.addEventListener("touchstart",this.onTouchStart_),t.addEventListener("touchmove",this.onTouchMove_),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(kt(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}onTouchEnd_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Vt(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)}function St(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Lt(t,e,i){return Math.min(Math.max(t,e),i)}const jt=p("txt");class It{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(jt(),jt(void 0,"num")),e.arrayPosition&&this.element.classList.add(jt(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(jt("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(jt()),this.inputElement.classList.add(jt("i"));const n=t.createElement("div");n.classList.add(jt("k")),this.element.appendChild(n),this.knobElement=n;const s=t.createElementNS(P,"svg");s.classList.add(jt("g")),this.knobElement.appendChild(s);const r=t.createElementNS(P,"path");r.classList.add(jt("gb")),s.appendChild(r),this.guideBodyElem_=r;const o=t.createElementNS(P,"path");o.classList.add(jt("gh")),s.appendChild(o),this.guideHeadElem_=o;const a=t.createElement("div");a.classList.add(p("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(jt(void 0,"drg"));this.element.classList.add(jt(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),n=Lt(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Ft{constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=w(null),this.view=new It(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_);const i=new Pt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}onInputChange_(t){const e=t.currentTarget.value,i=this.parser_(e);s(i)||(this.value.rawValue=i),this.view.refresh()}onInputKeyDown_(t){const e=zt(this.baseStep_,Et(t));0!==e&&(this.value.rawValue+=e)}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}onPointerMove_(t){if(!t.data.point)return;const e=t.data.point.x-t.data.bounds.width/2;this.value.rawValue=this.originRawValue_+e*this.props.get("draggingScale"),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_}onPointerUp_(){this.dragging_.rawValue=null}}function Nt(t,e){t.write(e)}function Tt(t,e){const i=t&&G(t,Y);return i?St(i.step):Math.max(St(e),2)}function Dt(t){const e=function(t){const e=t?G(t,Y):null;return e?e.step:null}(t);return null!=e?e:1}function Ot(t,e){var i;const n=t&&G(t,Y),s=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:e);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}class Kt{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var i,n;return null!==(n=null===(i=this.components[e])||void 0===i?void 0:i.constrain(t))&&void 0!==n?n:t}));return this.asm_.fromComponents(e)}}const qt=p("pndtxt");class Bt{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(qt()),this.textViews.forEach((e=>{const i=t.createElement("div");i.classList.add(qt("a")),i.appendChild(e.element),this.element.appendChild(i)}))}}class At{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((i,n)=>function(t,e,i){return new Ft(t,{arrayPosition:0===i?"fst":i===e.axes.length-1?"lst":"mid",baseStep:e.axes[i].baseStep,parser:e.parser,props:e.axes[i].textProps,value:w(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}(t,e,n))),this.acs_.forEach(((t,i)=>{Ct({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[i],backward:(t,n)=>{const s=e.assembly.toComponents(t.rawValue);return s[i]=n.rawValue,e.assembly.fromComponents(s)}})})),this.view=new Bt(t,{textViews:this.acs_.map((t=>t.view))})}}const $t={defaultInterval:200,defaultLineCount:3};class Ut{constructor(){this.emitter=new a,this.index_=-1}get index(){return this.index_}set index(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}}const Rt=p("grl");class Gt{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Rt()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(P,"svg");i.classList.add(Rt("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(P,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const s=t.createElement("div");s.classList.add(Rt("t"),p("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.minValue_,n=this.maxValue_,s=[];this.value.rawValue.forEach(((r,o)=>{if(void 0===r)return;const a=Vt(o,0,e,0,t.width),l=Vt(r,i,n,t.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const r=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0===o)return void r.classList.remove(Rt("t","a"));const a=Vt(this.cursor_.index,0,e,0,t.width),l=Vt(o,i,n,t.height,0);r.style.left=`${a}px`,r.style.top=`${l}px`,r.textContent=`${this.formatter_(o)}`,r.classList.contains(Rt("t","a"))||(r.classList.add(Rt("t","a"),Rt("t","in")),V(r),r.classList.remove(Rt("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Ht{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.cursor_=new Ut,this.view=new Gt(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:this.viewProps}),S(t)){const t=new Pt(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Vt(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.index=Math.floor(Vt(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}}class Yt{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.emitter.on(t,(()=>{n(new i(this))})),this}}class Zt extends i{constructor(t,e,i){super(t),this.cell=e,this.index=i}}class Xt extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new a;const e=this.controller_.valueController;e.cellControllers.forEach(((t,i)=>{const n=new Yt(t);this.cellToApiMap_.set(t,n),t.emitter.on("click",(()=>{const t=i%e.size[0],s=Math.floor(i/e.size[0]);this.emitter_.emit("click",{event:new Zt(this,n,[t,s])})}))}))}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,(t=>{i(t.event)})),this}}class Jt{constructor(t,e){this.size=e.size;const[i,n]=this.size,s=[];for(let r=0;r<n;r++)for(let n=0;n<i;n++){const i=new b(t,{props:_.fromObject(Object.assign({},e.cellConfig(n,r))),viewProps:A.create()});s.push(i)}this.cellCs_=s,this.viewProps=A.create(),this.viewProps.handleDispose((()=>{this.cellCs_.forEach((t=>{t.viewProps.set("disposed",!0)}))})),this.view=new O(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}}const Wt={id:"buttongrid",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept(t){const e=M,i=C(t,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new I(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:new Jt(t.document,{cellConfig:t.params.cells,size:t.params.size})}),api:t=>t.controller instanceof I&&t.controller.valueController instanceof Jt?new Xt(t.controller):null};class Qt extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get value(){return this.controller_.valueController.value.rawValue}}function te(t,e,i){return t*(1-i)+e*i}function ee(t,e){let i=.25,n=.5,s=-1;for(let r=0;r<20;r++){const[r,o]=t.curve(n);if(n+=i*(r<e?1:-1),s=o,i*=.5,Math.abs(e-r)<.001)break}return s}class ie{constructor(t=0,e=0,i=1,n=1){this.cache_=[],this.comps_=[t,e,i,n]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return!s(t)&&!!Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=te(0,this.x1,t),i=te(0,this.y1,t),n=te(this.x1,this.x2,t),s=te(this.y1,this.y2,t),r=te(this.x2,1,t),o=te(this.y2,1,t),a=te(e,n,t),l=te(i,s,t),p=te(n,r,t),h=te(s,o,t);return[te(a,p,t),te(l,h,t)]}y(t){if(0===this.cache_.length){const t=[];for(let e=0;e<100;e++)t.push(ee(this,Vt(e,0,99,0,1)));this.cache_=t}return this.cache_[Math.round(Vt(Lt(t,0,1),0,1,0,99))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const ne={toComponents:t=>t.toObject(),fromComponents:t=>new ie(...t)};function se(t){const e=_t(2);return`cubic-bezier(${t.toObject().map((t=>e(t))).join(", ")})`}const re=[0,.5,.5,1];function oe(t){const e=t.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new ie(...re);const i=[e[1],e[2],e[3],e[4]].reduce(((t,e)=>{if(!t)return null;const i=Number(e);return isNaN(i)?null:[...t,i]}),[]);return new ie(...null!=i?i:re)}const ae=p("cbz");class le{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ae()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,ae(void 0,"expanded")),u(e.foldable,"completed",d(this.element,ae(void 0,"cpl")));const i=t.createElement("div");i.classList.add(ae("h")),this.element.appendChild(i);const n=t.createElement("button");n.classList.add(ae("b")),e.viewProps.bindDisabled(n);const s=t.createElementNS(P,"svg");s.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',n.appendChild(s),i.appendChild(n),this.buttonElement=n;const r=t.createElement("div");if(r.classList.add(ae("t")),i.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(ae("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const pe=p("cbzp");class he{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pe()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(pe("g")),this.element.appendChild(i),this.graphElement=i;const n=t.createElement("div");n.classList.add(pe("t")),this.element.appendChild(n),this.textElement=n}}function ce(t,e){const i=new MutationObserver((t=>{for(const n of t)"childList"===n.type&&n.addedNodes.forEach((t=>{t.contains(t)&&(e(),i.disconnect())}))})),n=t.ownerDocument;i.observe(n.body,{attributes:!0,childList:!0,subtree:!0})}const ue=p("cbzg");class de{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ue()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(ue("p")),this.element.appendChild(i),this.previewElement=i;const n=t.createElementNS(P,"svg");n.classList.add(ue("g")),this.element.appendChild(n),this.svgElem_=n;const s=t.createElementNS(P,"path");s.classList.add(ue("u")),this.svgElem_.appendChild(s),this.guideElem_=s;const r=t.createElementNS(P,"polyline");r.classList.add(ue("l")),this.svgElem_.appendChild(r),this.lineElem_=r,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach((t=>{t.classList.add(ue("h")),this.element.appendChild(t)})),this.vectorElems_=[t.createElementNS(P,"line"),t.createElementNS(P,"line")],this.vectorElems_.forEach((t=>{t.classList.add(ue("v")),this.svgElem_.appendChild(t)})),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach(((t,e)=>{var i,n;c(this.sel_,(i=t=>t===e,n=d(t,ue("h","sel")),t=>n(i(t))))})),ce(this.element,(()=>{this.refresh()}))}getVertMargin_(t){return.25*t}valueToPosition(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,r=this.getVertMargin_(s);return{x:Vt(t,0,1,0,n),y:Vt(e,0,1,s-r,r)}}positionToValue(t,e){const i=this.element.getBoundingClientRect(),n=i.width,s=i.height,r=this.getVertMargin_(s);return{x:Lt(Vt(t,0,n,0,1),0,1),y:Vt(e,s-r,r,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map((t=>{const e=this.valueToPosition(0,t),i=this.valueToPosition(1,t);return[`M ${e.x},${e.y}`,`L ${i.x},${i.y}`].join(" ")})).join(" "));const t=this.value_.rawValue,e=[];let i=0;for(;;){const n=this.valueToPosition(...t.curve(i));if(e.push([n.x,n.y].join(",")),i>=1)break;i=Math.min(i+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const n=t.toObject();[0,1].forEach((t=>{const e=this.valueToPosition(t,t),i=this.valueToPosition(n[2*t],n[2*t+1]),s=this.vectorElems_[t];s.setAttributeNS(null,"x1",String(e.x)),s.setAttributeNS(null,"y1",String(e.y)),s.setAttributeNS(null,"x2",String(i.x)),s.setAttributeNS(null,"y2",String(i.y));const r=this.handleElems_[t];r.style.left=`${i.x}px`,r.style.top=`${i.y}px`}))}onValueChange_(){this.refresh()}}const ve=p("cbzprv");class me{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ve()),e.viewProps.bindClassModifiers(this.element);const i=t.createElementNS(P,"svg");i.classList.add(ve("g")),this.element.appendChild(i),this.svgElem_=i;const n=t.createElementNS(P,"path");n.classList.add(ve("t")),this.svgElem_.appendChild(n),this.ticksElem_=n;const s=t.createElement("div");s.classList.add(ve("m")),this.element.appendChild(s),this.markerElem_=s,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),ce(this.element,(()=>{this.refresh()}))}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(ve("m","a")),this.startTime_=(new Date).getTime()+400,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(ve("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(Lt(t,0,1));this.markerElem_.style.left=100*e+"%"}refresh(){const t=this.svgElem_.getBoundingClientRect(),e=t.width,i=t.height,n=[],s=this.value_.rawValue;for(let t=0;t<24;t++){const r=Vt(t,0,23,0,1),o=Vt(s.y(r),0,1,0,e);n.push(`M ${o},0 v${i}`)}this.ticksElem_.setAttributeNS(null,"d",n.join(" "))}onTimer_(){if(null===this.startTime_)return;const t=(new Date).getTime()-this.startTime_,e=t/1e3;this.updateMarker_(e),t>1400&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function be(t,e,i,n){const s=i-t,r=n-e;return Math.sqrt(s*s+r*r)}class ge{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=w(0),this.viewProps=e.viewProps,this.view=new de(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.prevView_=new me(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(t=>{t.stopImmediatePropagation(),t.preventDefault(),this.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);const i=new Pt(this.view.element);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e){const i=this.sel_.rawValue,n=this.value.rawValue.toObject(),s=this.view.positionToValue(t.x,t.y),r=e?function(t,e,i,n){const s=be(t,e,i,n),r=Math.atan2(n-e,i-t),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:t+Math.cos(o)*s,y:e+Math.sin(o)*s}}(i,i,s.x,s.y):s;n[2*i]=r.x,n[2*i+1]=r.y,this.value.rawValue=new ie(...n)}onPointerDown_(t){const e=t.data;if(!e.point)return;const i=this.value.rawValue,n=this.view.valueToPosition(i.x1,i.y1),s=be(e.point.x,e.point.y,n.x,n.y),r=this.view.valueToPosition(i.x2,i.y2),o=be(e.point.x,e.point.y,r.x,r.y);this.sel_.rawValue=s<=o?0:1,this.updateValue_(e.point,t.shiftKey)}onPointerMove_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey)}onKeyDown_(t){var e;(function(t){return"ArrowUp"===t||"ArrowDown"===t}(e=t.key)||"ArrowLeft"===e||"ArrowRight"===e)&&t.preventDefault();const i=this.sel_.rawValue,n=this.value.rawValue.toObject();n[2*i]+=zt(this.baseStep_,function(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}(t)),n[2*i+1]+=zt(this.baseStep_,Et(t)),this.value.rawValue=new ie(...n)}}class fe{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new he(t,{viewProps:this.viewProps}),this.gc_=new ge(t,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const i=Object.assign(Object.assign({},e.axis),{constraint:new H({max:1,min:0})}),n=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new At(t,{assembly:ne,axes:[i,n,i,n],parser:ft,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map((t=>t.inputElement))]}refresh(){this.gc_.refresh()}}class we{constructor(t,e){var i;this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=(i=e.expanded,N.create(i)),this.view=new le(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new tt(t,{parser:oe,props:_.fromObject({formatter:se}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===e.pickerLayout?new J(t,{viewProps:this.viewProps}):null;const n=new fe(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),c(this.popC_.shows,(t=>{t&&n.refresh()})),Ct({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),D(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;e&&this.popC_.view.element.contains(e)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=function(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!S(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_&&"Escape"===t.key&&(this.popC_.shows.rawValue=!1)}}const _e={id:"cubic-bezier",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept(t){const e=M,i=C(t,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((t=>"inline"===t||"popup"===t?t:void 0))});return i?{params:i}:null},controller(t){var e,i;const n=w(new ie(...t.params.value),{constraint:new Kt({assembly:ne,components:[0,1,2,3].map((t=>t%2==0?new H({min:0,max:1}):void 0))}),equals:ie.equals}),s=new we(t.document,{axis:{baseStep:.1,textProps:_.fromObject({draggingScale:.01,formatter:_t(2)})},expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,pickerLayout:null!==(i=t.params.picker)&&void 0!==i?i:"popup",value:n,viewProps:t.viewProps});return new K(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:s})},api:t=>t.controller instanceof K&&t.controller.valueController instanceof we?new Qt(t.controller):null};class xe extends e{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}class ye{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(0===this.timestamps_.length)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=20)return;const t=this.timestamps_.length-20;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach((t=>{t.frameCount-=e})),this.frameCount_-=e}end(t){if(null===this.start_)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const Me=p("fps");class Ce{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Me()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(Me("g")),this.element.appendChild(this.graphElement);const i=t.createElement("div");i.classList.add(Me("l")),this.element.appendChild(i);const n=t.createElement("span");n.classList.add(Me("v")),n.textContent="--",i.appendChild(n),this.valueElement=n;const s=t.createElement("span");s.classList.add(Me("u")),s.textContent="FPS",i.appendChild(s)}}class ze{constructor(t,e){this.stopwatch_=new ye,this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new Ce(t,{viewProps:this.viewProps}),this.graphC_=new Ht(t,{formatter:_t(0),lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()}))}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.stopwatch_.fps;if(null!==t){const e=this.value_.rawValue;this.value_.rawValue=function(t,e){const i=[...Mt(t),e];return i.length>t.length?i.splice(0,i.length-t.length):xt(i,t.length),i}(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}function Ee(t,e){return 0===e?new $:new U(t,null!=e?e:$t.defaultInterval)}const ke={id:"fpsgraph",type:"blade",accept(t){const e=M,i=C(t,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return i?{params:i}:null},controller(t){var e,i,n,s;const r=null!==(e=t.params.interval)&&void 0!==e?e:500;return new I(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:new ze(t.document,{lineCount:null!==(i=t.params.lineCount)&&void 0!==i?i:2,maxValue:null!==(n=t.params.max)&&void 0!==n?n:90,minValue:null!==(s=t.params.min)&&void 0!==s?s:0,ticker:Ee(t.document,r),value:yt(80),viewProps:t.viewProps})})},api:t=>t.controller instanceof I&&t.controller.valueController instanceof ze?new xe(t.controller):null};class Pe{constructor(t,e){this.min=t,this.max=e}static isObject(t){if("object"!=typeof t||null===t)return!1;const e=t.min,i=t.max;return"number"==typeof e&&"number"==typeof i}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Ve={fromComponents:t=>new Pe(t[0],t[1]),toComponents:t=>[t.min,t.max]};class Se{constructor(t){this.edge=t}constrain(t){var e,i,n,s,r,o,a,l;if(t.min<=t.max)return new Pe(null!==(i=null===(e=this.edge)||void 0===e?void 0:e.constrain(t.min))&&void 0!==i?i:t.min,null!==(s=null===(n=this.edge)||void 0===n?void 0:n.constrain(t.max))&&void 0!==s?s:t.max);const p=(t.min+t.max)/2;return new Pe(null!==(o=null===(r=this.edge)||void 0===r?void 0:r.constrain(p))&&void 0!==o?o:p,null!==(l=null===(a=this.edge)||void 0===a?void 0:a.constrain(p))&&void 0!==l?l:p)}}const Le=p("rsltxt");class je{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(Le());const i=t.createElement("div");i.classList.add(Le("s")),i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=t.createElement("div");n.classList.add(Le("t")),n.appendChild(this.textView_.element),this.element.appendChild(n)}}const Ie=p("rsl");class Fe{constructor(t,e){this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.element=t.createElement("div"),this.element.classList.add(Ie()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this));const i=t.createElement("div");i.classList.add(Ie("t")),this.element.appendChild(i),this.trackElement=i;const n=t.createElement("div");n.classList.add(Ie("b")),i.appendChild(n),this.barElement=n;const s=["min","max"].map((e=>{const n=t.createElement("div");return n.classList.add(Ie("k"),Ie("k",e)),i.appendChild(n),n}));this.knobElements=[s[0],s[1]],this.update()}valueToX_(t){return 100*Lt(Vt(t,this.minValue_,this.maxValue_,0,1),0,1)}update(){const t=this.value_.rawValue;0===t.length?this.element.classList.add(Ie(void 0,"zero")):this.element.classList.remove(Ie(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=100-e[1]+"%",this.knobElements.forEach(((t,i)=>{t.style.left=`${e[i]}%`}))}onValueChange_(){this.update()}}class Ne{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.viewProps=e.viewProps,this.value=e.value,this.view=new Fe(t,{maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:e.viewProps});const i=new Pt(this.view.trackElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}ofs_(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){return t.point?Vt((t.point.x+this.ofs_())/t.bounds.width,0,1,this.minValue_,this.maxValue_):null}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,i=this.value.rawValue,n=Vt(i.min,this.minValue_,this.maxValue_,0,1),s=Vt(i.max,this.minValue_,this.maxValue_,0,1);Math.abs(s-e)<=.025?this.grabbing_="max":Math.abs(n-e)<=.025?this.grabbing_="min":e>=n&&e<=s?(this.grabbing_="length",this.grabOffset_=Vt(e-n,0,1,this.minValue_,this.maxValue_)):e<n?(this.grabbing_="min",this.onPointerMove_(t)):e>s&&(this.grabbing_="max",this.onPointerMove_(t))}onPointerMove_(t){const e=this.valueFromData_(t.data);if(null!==e)if("min"===this.grabbing_)this.value.rawValue=new Pe(e,this.value.rawValue.max);else if("max"===this.grabbing_)this.value.rawValue=new Pe(this.value.rawValue.min,e);else if("length"===this.grabbing_){const t=this.value.rawValue.length;let i=e-this.grabOffset_,n=i+t;i<this.minValue_?(i=this.minValue_,n=this.minValue_+t):n>this.maxValue_&&(i=this.maxValue_-t,n=this.maxValue_),this.value.rawValue=new Pe(i,n)}}onPointerUp_(t){this.grabbing_=null}}class Te{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new Ne(t,e);const i={baseStep:e.baseStep,constraint:e.constraint,textProps:_.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new At(t,{assembly:Ve,axes:[i,i],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new je(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function De(t){return Pe.isObject(t)?new Pe(t.min,t.max):new Pe(0,0)}function Oe(t,e){t.writeProperty("max",e.max),t.writeProperty("min",e.min)}function Ke(t){const e=[],i=function(t){return"max"in t&&!s(t.max)||"min"in t&&!s(t.min)?new H({max:t.max,min:t.min}):null}(t);i&&e.push(i);const n=function(t){return"step"in t&&!s(t.step)?new Y(t.step):null}(t);return n&&e.push(n),new Se(new R(e))}const qe={id:"input-interval",type:"input",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:(t,e)=>{if(!Pe.isObject(t))return null;const i=M,n=C(e,{max:i.optional.number,min:i.optional.number,step:i.optional.number});return n?{initialValue:new Pe(t.min,t.max),params:n}:null},binding:{reader:t=>De,constraint:t=>Ke(t.params),equals:Pe.equals,writer:t=>Oe},controller(t){const e=t.value,i=t.constraint;if(!(i instanceof Se))throw o.shouldNeverHappen();const n=(e.rawValue.min+e.rawValue.max)/2,s=i.edge&&G(i.edge,H);if(void 0!==(null==s?void 0:s.minValue)&&void 0!==(null==s?void 0:s.maxValue))return new Te(t.document,{baseStep:Dt(i.edge),constraint:i.edge,draggingScale:Ot(s,n),formatter:_t(Tt(i.edge,n)),maxValue:s.maxValue,minValue:s.minValue,parser:ft,value:e,viewProps:t.viewProps});const r={baseStep:Dt(i.edge),constraint:i.edge,textProps:_.fromObject({draggingScale:n,formatter:_t(Tt(i.edge,n))})};return new At(t.document,{assembly:Ve,axes:[r,r],parser:ft,value:e,viewProps:t.viewProps})}};class Be{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.props.set("title",t)}}class Ae extends n{constructor(t,e,i,n,s){super(t,n,s),this.cell=e,this.index=i}}class $e extends e{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach((t=>{const e=new Be(t);this.cellToApiMap_.set(t,e)}))}get value(){return this.controller_.value}cell(t,e){const i=this.controller_.valueController,n=i.cellControllers[e*i.size[0]+t];return this.cellToApiMap_.get(n)}on(t,e){const i=e.bind(this);this.controller_.value.emitter.on(t,(t=>{const e=this.controller_.valueController,n=e.findCellByValue(t.rawValue);if(!n)return;const s=this.cellToApiMap_.get(n);if(!s)return;const r=e.cellControllers.indexOf(n);i(new Ae(this,s,[r%e.size[0],Math.floor(r/e.size[0])],t.rawValue,void 0))}))}}const Ue=p("rad");class Re{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ue()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(Ue("l")),this.element.appendChild(i);const n=t.createElement("input");n.classList.add(Ue("i")),n.name=e.name,n.type="radio",e.viewProps.bindDisabled(n),i.appendChild(n),this.inputElement=n;const s=t.createElement("div");s.classList.add(Ue("b")),i.appendChild(s);const r=t.createElement("div");r.classList.add(Ue("t")),s.appendChild(r),u(e.props,"title",(t=>{r.textContent=t}))}}class Ge{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Re(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class He{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[i,n]=this.size;for(let s=0;s<n;s++)for(let n=0;n<i;n++){const i=new Ge(t,{name:e.groupName,props:_.fromObject(Object.assign({},e.cellConfig(n,s))),viewProps:A.create()});this.cellCs_.push(i),this.cellValues_.push(e.cellConfig(n,s).value)}this.value=e.value,c(this.value,(t=>{const e=this.findCellByValue(t);e&&(e.view.inputElement.checked=!0)})),this.viewProps=A.create(),this.view=new O(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach((t=>{t.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(t.view.element)}))}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex((e=>e===t));return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,i=this.cellCs_.findIndex((t=>t.view.inputElement===e));i<0||(this.value.rawValue=this.cellValues_[i])}}const Ye=[Wt,_e,ke,qe,{id:"radiogrid",type:"blade",accept(t){const e=M,i=C(t,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return i?{params:i}:null},controller:t=>new K(t.document,{blade:t.blade,props:_.fromObject({label:t.params.label}),valueController:new He(t.document,{groupName:t.params.groupName,cellConfig:t.params.cells,size:t.params.size,value:w(t.params.value)})}),api:t=>t.controller instanceof K&&t.controller.valueController instanceof He?new $e(t.controller):null},{id:"input-radiogrid",type:"input",accept(t,e){if("number"!=typeof t)return null;const i=M,n=C(e,{cells:i.required.function,groupName:i.required.string,size:i.required.array(i.required.number),view:i.required.constant("radiogrid")});return n?{initialValue:t,params:n}:null},binding:{reader:t=>wt,writer:t=>Nt},controller:t=>new He(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}];t.plugins=Ye,Object.defineProperty(t,"__esModule",{value:!0})}(e)}));const g=(0,r.b)(b);var f=b.plugins;const w={model:"",outputSize:260,minClusterSize:.02,numColors:4,numValidSubsets:"",edgePoints:"",scale:1,origin:{x:0,y:0},numLejaPoints:32,maxIterations:8},_=(t,e,i)=>{if(0==t.length)return e[i].abs();var n=1;for(let s=0;s<t.length;s++)n*=e[i].sub(t[s]).abs();return n},x=t=>{let e=1;for(let i=0;i<t.length-1;i++)e*=t[t.length-1].sub(t[i]).abs();return e},y=t=>{let e=0,i=0;for(let n=0;n<t.length;n++){let s=t[n];e+=s.re,i+=s.im}return e/=t.length,i/=t.length,new o(e,i)};var M=i(8075),C=i(2069);const z="source";function E(t,e,i){var n,s,r;if(0==e)n=s=r=i;else{var o=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},a=i<.5?i*(1+e):i+e-i*e,l=2*i-a;n=o(l,a,t+1/3),s=o(l,a,t),r=o(l,a,t-1/3)}return[Math.round(255*n),Math.round(255*s),Math.round(255*r)]}const k=async t=>await(0,s.z)({base:t,quantizationBytes:4});i(1026),M.N("webgl");const P=(()=>{const t=window.location.search,e=new URLSearchParams(t);let i=e.get("img");const n=e.get("nc"),s=e.get("nl"),r=e.get("mi");return null!=n&&(w.numColors=parseInt(n)),null!=s&&(w.numLejaPoints=parseInt(s)),null!=r&&(w.maxIterations=parseInt(r)),null==i&&(i="https://source.unsplash.com/random?eagle,lion,frog,mosque,cathedral"),i})(),[V]=(()=>{const t=new a.X({container:document.getElementById("settingsPanel"),title:"Parameters",expanded:!1});t.registerPlugin(n),w.outputSize=Math.floor(513),t.addInput(w,"model",{options:{ade20k:"ade20k",pascal:"pascal",cityscapes:"cityscapes"}}).on("change",(t=>{L()})),t.addInput(w,"numLejaPoints",{min:4,max:64,step:1}),t.addSeparator(),t.addInput(w,"maxIterations",{min:4,max:64,step:1}).on("change",(t=>{d()})),t.addInput(w,"scale",{min:.1,max:10,step:.1}).on("change",(t=>{d()})),t.addInput(w,"origin",{picker:"inline",expanded:!1}).on("change",(t=>{d()})),t.addSeparator(),t.addMonitor(w,"numValidSubsets"),t.addMonitor(w,"edgePoints"),t.addSeparator();const e=t.addBlade({view:"fpsgraph",label:"fpsgraph"});return[t,e]})(),S={models:{pascal:null,ade20k:null,cityscapes:null},imgData:null},L=async()=>{const t=S.imgData,e=S.models[w.model],{legend:i,segmentationMap:n}=await(async(t,e)=>{const{legend:i,segmentationMap:n}=await t.segment(e);return{legend:i,segmentationMap:n}})(e,t),[s,r,a]=await(async(t,e)=>{const i=t.width,n=t.height;let s={},r={},o={},a=M.z([n,i]).bufferSync();const l=C.cj.fromPixels(new ImageData(e,i,n)).bufferSync(),p=(t,e,s,r,o)=>{if(!(r<i&&r>=0&&o<n&&o>=0))return!1;const p=a.get(o,r)!=t;let h=!0;return[0,1,2].forEach((t=>{h=h&&l.get(o,r,t)==l.get(s,e,t)})),!(!p||!h)},h=(e,n)=>{let s,r,o=[e],l=0,h=0,c=0,u=0;for(;o.length>0;){[s,r]=o.pop(),a.set(n,s,r),l++;let e=4*(r+s*i);h+=t.data[e]/255,c+=t.data[e+1]/255,u+=t.data[e+2]/255,[[s,r+1],[s,r-1],[s+1,r],[s-1,r]].forEach((([t,e])=>{p(n,r,s,e,t)&&o.push([t,e])}))}return[l,[h/l,c/l,u/l]]};let c=1;for(let t=0;t<i;t++)for(let e=0;e<n;e++)if(0==a.get(e,t)){let[i,n]=h([e,t],c);i>500&&(r[c]=n,s[c]=[],o[c]=i),c++}for(let t=1;t<i-1;t++)for(let e=1;e<n-1;e++){const i=a.get(e,t);i in r&&(a.get(e,t-1)!=i||a.get(e,t+1)!=i||a.get(e+1,t)!=i||a.get(e-1,t)!=i||a.get(e-1,t-1)!=i||a.get(e+1,t+1)!=i||a.get(e+1,t-1)!=i||a.get(e-1,t+1)!=i)&&s[i].push([t,e])}const u=document.getElementById(z).getContext("2d");u.putImageData(t,0,0);for(let t=0;t<i;t++)for(let e=0;e<n;e++){let i=a.get(e,t);if(i in r){let[n,s,r]=E(.5*(1+Math.sin(130.1*i)),.8,.9);u.fillStyle=`rgba(${n},${s},${r},0.7)`,u.fillRect(t,e,1,1)}}w.numValidSubsets=Object.keys(s).length;for(let t in s){const e=s[t];for(let t=0;t<e.length;t++){let[i,n]=e[t];u.fillStyle="rgba(255,100,100,0.5)",u.fillRect(i,n,1,1)}}return[s,r,o]})(t,n),[d,b]=((t,e,i)=>{let n={};const s=new o(w.origin.x,w.origin.y);function r(t,n){let r=(t*(2/e)-1+s.re)*w.scale,a=(n*(2/i)-1+s.im)*w.scale;return new o(r,a)}let a=0,l={};for(let e in t){let i=t[e];l[e]=[];for(let t=0;t<i.length;t++)l[e].push(r(i[t][0],i[t][1])),a++}let p=Math.floor(100*a/(e*i));w.complexPoints=`${a} / ${e*i} (${p}%)`;for(let t in l){let e=y(l[t]);n[t]=e;for(let i=0;i<l[t].length;i++)l[t][i]=l[t][i].sub(e)}return[l,n]})(s,t.width,t.height),g=(t=>{let e={};for(var i in t){const o=t[i],a=Math.min(w.numLejaPoints,Math.floor(o.length/2));let l=[];for(let t=0;t<a;t++){var n=0,s=0,r=0;for(let t=0;t<o.length;t++)(r=_(l,o,t))>n&&(n=r,s=t);l.push(o[s]),o.splice(s,1)}e[i]=l}return e})(d);((t,e,i,n,s)=>{if(u.length>0)return void((t,e)=>{for(let i in t)v(u[i],e[i],t[i].length,t[i])})(t,e);if(null==p)(()=>{const[t,e]=m();p=new l.CP7({alpha:!0,depth:!1});const i=document.getElementById("fractal-container");p.setSize(t,e),i.appendChild(p.domElement),h=new l.iKG(-1,1,1,-1,.1,10),h.position.z=3})();else{const[t,e]=m();p.setSize(t,e)}let r=0;for(let t in s)s[t]>r&&(r=s[t]);c=new l.xsS;for(let o in t){let a=t[o],p=e[o],h=i[o],d=s[o],m=n[o];const b=new l.BKK(2,2);b.translate(0,0,d/r*-.1);const g=new l.jyz({uniforms:{an:{value:p},nl:{value:a.length},time:{value:0},maxIterations:{value:8},scale:{value:1},color:{value:new l.Pa4(m[0],m[1],m[2])},origin:{value:new l.FM8(h.re,h.im)},l1:{value:new l.FM8},l2:{value:new l.FM8},l3:{value:new l.FM8},l4:{value:new l.FM8},l5:{value:new l.FM8},l6:{value:new l.FM8},l7:{value:new l.FM8},l8:{value:new l.FM8},l9:{value:new l.FM8},l10:{value:new l.FM8},l11:{value:new l.FM8},l12:{value:new l.FM8},l13:{value:new l.FM8},l14:{value:new l.FM8},l15:{value:new l.FM8},l16:{value:new l.FM8},l17:{value:new l.FM8},l18:{value:new l.FM8},l19:{value:new l.FM8},l20:{value:new l.FM8},l21:{value:new l.FM8},l22:{value:new l.FM8},l23:{value:new l.FM8},l24:{value:new l.FM8},l25:{value:new l.FM8},l26:{value:new l.FM8},l27:{value:new l.FM8},l28:{value:new l.FM8},l29:{value:new l.FM8},l30:{value:new l.FM8},l31:{value:new l.FM8},l32:{value:new l.FM8},l33:{value:new l.FM8},l34:{value:new l.FM8},l35:{value:new l.FM8},l36:{value:new l.FM8},l37:{value:new l.FM8},l38:{value:new l.FM8},l39:{value:new l.FM8},l40:{value:new l.FM8},l41:{value:new l.FM8},l42:{value:new l.FM8},l43:{value:new l.FM8},l44:{value:new l.FM8},l45:{value:new l.FM8},l46:{value:new l.FM8},l47:{value:new l.FM8},l48:{value:new l.FM8},l49:{value:new l.FM8},l50:{value:new l.FM8},l51:{value:new l.FM8},l52:{value:new l.FM8},l53:{value:new l.FM8},l54:{value:new l.FM8},l55:{value:new l.FM8},l56:{value:new l.FM8},l57:{value:new l.FM8},l58:{value:new l.FM8},l59:{value:new l.FM8},l60:{value:new l.FM8},l61:{value:new l.FM8},l62:{value:new l.FM8},l63:{value:new l.FM8},l64:{value:new l.FM8}},vertexShader:"\n    varying vec3 vUv;\n    \n    void main() {\n        vUv = position;\n\n        vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n        gl_Position = projectionMatrix * modelViewPosition;    }\n    ",fragmentShader:"\n    uniform float an;\n    uniform int nl;\n    uniform float time;\n    uniform int maxIterations;\n    uniform float scale;\n    uniform vec2 origin;\n    uniform vec3 color;\n\n    uniform vec2 l1;\n    uniform vec2 l2;\n    uniform vec2 l3;\n    uniform vec2 l4;\n    uniform vec2 l5;\n    uniform vec2 l6;\n    uniform vec2 l7;\n    uniform vec2 l8;\n    uniform vec2 l9;\n    uniform vec2 l10;\n    uniform vec2 l11;\n    uniform vec2 l12;\n    uniform vec2 l13;\n    uniform vec2 l14;\n    uniform vec2 l15;\n    uniform vec2 l16;\n    uniform vec2 l17;\n    uniform vec2 l18;\n    uniform vec2 l19;\n    uniform vec2 l20;\n    uniform vec2 l21;\n    uniform vec2 l22;\n    uniform vec2 l23;\n    uniform vec2 l24;\n    uniform vec2 l25;\n    uniform vec2 l26;\n    uniform vec2 l27;\n    uniform vec2 l28;\n    uniform vec2 l29;\n    uniform vec2 l30;\n    uniform vec2 l31;\n    uniform vec2 l32; \n    uniform vec2 l33;\n    uniform vec2 l34;\n    uniform vec2 l35;\n    uniform vec2 l36;\n    uniform vec2 l37;\n    uniform vec2 l38;\n    uniform vec2 l39;\n    uniform vec2 l40;\n    uniform vec2 l41;\n    uniform vec2 l42;\n    uniform vec2 l43;\n    uniform vec2 l44;\n    uniform vec2 l45;\n    uniform vec2 l46;\n    uniform vec2 l47;\n    uniform vec2 l48;\n    uniform vec2 l49;\n    uniform vec2 l50;\n    uniform vec2 l51;\n    uniform vec2 l52;\n    uniform vec2 l53;\n    uniform vec2 l54;\n    uniform vec2 l55;\n    uniform vec2 l56;\n    uniform vec2 l57;\n    uniform vec2 l58;\n    uniform vec2 l59;\n    uniform vec2 l60;\n    uniform vec2 l61;\n    uniform vec2 l62;\n    uniform vec2 l63;\n    uniform vec2 l64;\n\n    varying vec3 vUv;\n\n    // from https://stackoverflow.com/questions/4200224/random-noise-functions-for-glsl\n\n    // A single iteration of Bob Jenkins' One-At-A-Time hashing algorithm.\n    uint hash( uint x ) {\n        x += ( x << 10u );\n        x ^= ( x >>  6u );\n        x += ( x <<  3u );\n        x ^= ( x >> 11u );\n        x += ( x << 15u );\n        return x;\n    }\n\n    // Construct a float with half-open range [0:1] using low 23 bits.\n    // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.\n    float floatConstruct( uint m ) {\n        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask\n        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32\n\n        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)\n        m |= ieeeOne;                          // Add fractional part to 1.0\n\n        float  f = uintBitsToFloat( m );       // Range [1:2]\n        return f - 1.0;                        // Range [0:1]\n    }\n\n    // Pseudo-random value in half-open range [0:1].\n    float random( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }\n\n    vec2 lejaStep(vec2 z, vec2 p, vec2 l, int n) {\n        if (n > nl) return p;\n        vec2 r = vec2(z.x-l.x, z.y-l.y);\n        vec2 p2 = vec2(p.x * r.x - p.y * r.y, p.x * r.y + p.y * r.x);\n        return p2;\n    }\n\n    vec2 P(vec2 z) {\n        vec2 p = vec2(z.x - l1.x,z.y - l1.y);\n        \n        p = lejaStep(z,p,l2,2);\n        p = lejaStep(z,p,l3,3);\n        p = lejaStep(z,p,l4,4);\n        p = lejaStep(z,p,l5,5);\n        p = lejaStep(z,p,l6,6);\n        p = lejaStep(z,p,l7,7);\n        p = lejaStep(z,p,l8,8);\n        p = lejaStep(z,p,l9,9);\n        p = lejaStep(z,p,l10,10);\n        p = lejaStep(z,p,l11,11);\n        p = lejaStep(z,p,l12,12);\n        p = lejaStep(z,p,l13,13);\n        p = lejaStep(z,p,l14,14);\n        p = lejaStep(z,p,l15,15);\n        p = lejaStep(z,p,l16,16);\n        p = lejaStep(z,p,l17,17);\n        p = lejaStep(z,p,l18,18);\n        p = lejaStep(z,p,l19,19);\n        p = lejaStep(z,p,l20,20);\n        p = lejaStep(z,p,l21,21);\n        p = lejaStep(z,p,l22,22);\n        p = lejaStep(z,p,l23,23);\n        p = lejaStep(z,p,l24,24);\n        p = lejaStep(z,p,l25,25);\n        p = lejaStep(z,p,l26,26);\n        p = lejaStep(z,p,l27,27);\n        p = lejaStep(z,p,l28,28);\n        p = lejaStep(z,p,l29,29);\n        p = lejaStep(z,p,l30,30);\n        p = lejaStep(z,p,l31,31);\n        p = lejaStep(z,p,l32,32); \n        p = lejaStep(z,p,l33,33);\n        p = lejaStep(z,p,l34,34);\n        p = lejaStep(z,p,l35,35);\n        p = lejaStep(z,p,l36,36);\n        p = lejaStep(z,p,l37,37);\n        p = lejaStep(z,p,l38,38);\n        p = lejaStep(z,p,l39,39);\n        p = lejaStep(z,p,l40,40);\n        p = lejaStep(z,p,l41,41);\n        p = lejaStep(z,p,l42,42);\n        p = lejaStep(z,p,l43,43);\n        p = lejaStep(z,p,l44,44);\n        p = lejaStep(z,p,l45,45);\n        p = lejaStep(z,p,l46,46);\n        p = lejaStep(z,p,l47,47);\n        p = lejaStep(z,p,l48,48);\n        p = lejaStep(z,p,l49,49);\n        p = lejaStep(z,p,l50,50);\n        p = lejaStep(z,p,l51,51);\n        p = lejaStep(z,p,l52,52);\n        p = lejaStep(z,p,l53,53);\n        p = lejaStep(z,p,l54,54);\n        p = lejaStep(z,p,l55,55);\n        p = lejaStep(z,p,l56,56);\n        p = lejaStep(z,p,l57,57);\n        p = lejaStep(z,p,l58,58);\n        p = lejaStep(z,p,l59,59);\n        p = lejaStep(z,p,l60,60);\n        p = lejaStep(z,p,l61,61);\n        p = lejaStep(z,p,l62,62);\n        p = lejaStep(z,p,l63,63);\n        p = lejaStep(z,p,l64,64);\n\n        float scale = exp(0.5) / an;\n        return vec2(p.x*z.x - p.y*z.y, p.x*z.y + p.y*z.x) * scale;\n        \n    }\n\n    vec3 hsv2rgb(vec3 c)\n    {\n        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n\n    void main() {\n        vec2 z = (vec2(vUv.x, -vUv.y) - origin) / (scale + 0.05 * sin(0.1 * time));\n        float len = 0.0;\n        int iterations = 0;\n        for (;iterations < maxIterations; iterations++) {\n            if (length(z) > 2.0) {\n                break;\n            }\n            vec2 tmp = P(z);\n            len += length(z - tmp);\n            z = tmp;\n        }\n        // float h =  0.5 * sin(time * 0.01) + random(an + l1.y);//random(l2.y + l2.x);\n        // float s = 0.65;\n        float v = float(iterations)/float(maxIterations);\n        float a = v - 0.2;\n        if (a < 0.1) {\n          discard;\n        }\n        gl_FragColor = vec4(color, a);\n    }\n",depthTest:!1,depthWrite:!1,transparent:!0}),f=new l.Kj0(b,g);c.add(f),u[o]=f,v(o,p,a.length,a)}!function t(){requestAnimationFrame(t);for(let t in u)u[t].material.uniforms.time.value+=.01;p.render(c,h)}()})(g,(t=>{var e={};for(var i in t){let n=t[i];e[i]=x(n)}return e})(g),b,r,a)},j=async t=>{for(let t in S.models)null==S.models[t]&&(S.models[t]=await k(t));let{imgData:e}=await(t=>{return e=t,new Promise((t=>{const i=document.getElementById("source"),n=i.getContext("2d"),s=new Image;s.setAttribute("crossOrigin",""),s.onload=()=>{let e=Math.max(s.width,s.height),r=Math.floor(s.width*(w.outputSize/e)),o=Math.floor(s.height*(w.outputSize/e));i.width=r,i.height=o,n.drawImage(s,0,0,s.width,s.height,0,0,r,o),t({width:r,height:o,imgData:n.getImageData(0,0,r,o)})},s.src=e}));var e})(t);S.imgData=e,L()};document.addEventListener("keypress",(t=>{console.log(t)," "==t.key||t.key}));const I=document.getElementById("drop");document.getElementById("fractal-container"),I.addEventListener("dragover",(function(t){this.classList.add("dragging"),t.preventDefault()})),I.addEventListener("dragleave",(function(t){this.classList.remove("dragging"),t.preventDefault()})),I.addEventListener("drop",(async function(t){if(this.classList.remove("dragging"),t.preventDefault(),t.dataTransfer.items)for(var e=0;e<t.dataTransfer.items.length;e++)if("file"===t.dataTransfer.items[e].kind&&t.dataTransfer.items[e].type.match("^image/")){var i=t.dataTransfer.items[e].getAsFile();j(URL.createObjectURL(i))}})),j(P)}},t=>{"use strict";t.O(0,[949,475,260,281,955,459,115],(()=>(8693,t(t.s=8693)))),t.O()}]);